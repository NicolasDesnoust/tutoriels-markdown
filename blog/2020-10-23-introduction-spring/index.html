<!DOCTYPE html><html lang="fr"><head><meta name="generator" content="Scully 1.1.0">
    <meta charset="utf-8">
    <title>Desnote Book</title>
    <base href="/Desnote-Book/">
    <meta name="viewport" content="width=device-width">
    <style type="text/css">svg:not(:root).svg-inline--fa {
  overflow: visible;
}

.svg-inline--fa {
  display: inline-block;
  font-size: inherit;
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.225em;
}
.svg-inline--fa.fa-w-1 {
  width: 0.0625em;
}
.svg-inline--fa.fa-w-2 {
  width: 0.125em;
}
.svg-inline--fa.fa-w-3 {
  width: 0.1875em;
}
.svg-inline--fa.fa-w-4 {
  width: 0.25em;
}
.svg-inline--fa.fa-w-5 {
  width: 0.3125em;
}
.svg-inline--fa.fa-w-6 {
  width: 0.375em;
}
.svg-inline--fa.fa-w-7 {
  width: 0.4375em;
}
.svg-inline--fa.fa-w-8 {
  width: 0.5em;
}
.svg-inline--fa.fa-w-9 {
  width: 0.5625em;
}
.svg-inline--fa.fa-w-10 {
  width: 0.625em;
}
.svg-inline--fa.fa-w-11 {
  width: 0.6875em;
}
.svg-inline--fa.fa-w-12 {
  width: 0.75em;
}
.svg-inline--fa.fa-w-13 {
  width: 0.8125em;
}
.svg-inline--fa.fa-w-14 {
  width: 0.875em;
}
.svg-inline--fa.fa-w-15 {
  width: 0.9375em;
}
.svg-inline--fa.fa-w-16 {
  width: 1em;
}
.svg-inline--fa.fa-w-17 {
  width: 1.0625em;
}
.svg-inline--fa.fa-w-18 {
  width: 1.125em;
}
.svg-inline--fa.fa-w-19 {
  width: 1.1875em;
}
.svg-inline--fa.fa-w-20 {
  width: 1.25em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: 0.3em;
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: 0.3em;
  width: auto;
}
.svg-inline--fa.fa-border {
  height: 1.5em;
}
.svg-inline--fa.fa-li {
  width: 2em;
}
.svg-inline--fa.fa-fw {
  width: 1.25em;
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: #ff253a;
  border-radius: 1em;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  color: #fff;
  height: 1.5em;
  line-height: 1;
  max-width: 5em;
  min-width: 1.5em;
  overflow: hidden;
  padding: 0.25em;
  right: 0;
  text-overflow: ellipsis;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: 0;
  right: 0;
  top: auto;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: 0;
  left: 0;
  right: auto;
  top: auto;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  right: 0;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: 0;
  right: auto;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-lg {
  font-size: 1.3333333333em;
  line-height: 0.75em;
  vertical-align: -0.0667em;
}

.fa-xs {
  font-size: 0.75em;
}

.fa-sm {
  font-size: 0.875em;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: 2.5em;
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: -2em;
  position: absolute;
  text-align: center;
  width: 2em;
  line-height: inherit;
}

.fa-border {
  border: solid 0.08em #eee;
  border-radius: 0.1em;
  padding: 0.2em 0.25em 0.15em;
}

.fa-pull-left {
  float: left;
}

.fa-pull-right {
  float: right;
}

.fa.fa-pull-left,
.fas.fa-pull-left,
.far.fa-pull-left,
.fal.fa-pull-left,
.fab.fa-pull-left {
  margin-right: 0.3em;
}
.fa.fa-pull-right,
.fas.fa-pull-right,
.far.fa-pull-right,
.fal.fa-pull-right,
.fab.fa-pull-right {
  margin-left: 0.3em;
}

.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
          animation: fa-spin 2s infinite linear;
}

.fa-pulse {
  -webkit-animation: fa-spin 1s infinite steps(8);
          animation: fa-spin 1s infinite steps(8);
}

@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}

@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical,
:root .fa-flip-both {
  -webkit-filter: none;
          filter: none;
}

.fa-stack {
  display: inline-block;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: #fff;
}

.sr-only {
  border: 0;
  clip: rect(0, 0, 0, 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

.sr-only-focusable:active, .sr-only-focusable:focus {
  clip: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  position: static;
  width: auto;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: 1;
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: 0.4;
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: 0.4;
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: 1;
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse {
  color: #fff;
}</style><link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <style type="text/css">@font-face{font-family:'Josefin Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/josefinsans/v17/Qw3PZQNVED7rKGKxtqIqX5E-AVSJrOCfjY46_N_XXMI.woff) format('woff');}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-U1UQ.woff) format('woff');}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirk-Vg.woff) format('woff');}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rg-Vg.woff) format('woff');}@font-face{font-family:'Josefin Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/josefinsans/v17/Qw3PZQNVED7rKGKxtqIqX5E-AVSJrOCfjY46_N_XbMlhKSbpUVzEEaq2.woff) format('woff');unicode-range:U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;}@font-face{font-family:'Josefin Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/josefinsans/v17/Qw3PZQNVED7rKGKxtqIqX5E-AVSJrOCfjY46_N_XbMhhKSbpUVzEEaq2.woff) format('woff');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Josefin Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/josefinsans/v17/Qw3PZQNVED7rKGKxtqIqX5E-AVSJrOCfjY46_N_XbMZhKSbpUVzEEQ.woff) format('woff');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFWJ0bf8pkAp6a.woff2) format('woff2');unicode-range:U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFUZ0bf8pkAp6a.woff2) format('woff2');unicode-range:U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFWZ0bf8pkAp6a.woff2) format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFVp0bf8pkAp6a.woff2) format('woff2');unicode-range:U+0370-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFWp0bf8pkAp6a.woff2) format('woff2');unicode-range:U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFW50bf8pkAp6a.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFVZ0bf8pkAg.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirkOX-hpKKSTj5PW.woff2) format('woff2');unicode-range:U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirkOVuhpKKSTj5PW.woff2) format('woff2');unicode-range:U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirkOXuhpKKSTj5PW.woff2) format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirkOUehpKKSTj5PW.woff2) format('woff2');unicode-range:U+0370-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirkOXehpKKSTj5PW.woff2) format('woff2');unicode-range:U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirkOXOhpKKSTj5PW.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirkOUuhpKKSTjw.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOX-hpKKSTj5PW.woff2) format('woff2');unicode-range:U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOVuhpKKSTj5PW.woff2) format('woff2');unicode-range:U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOXuhpKKSTj5PW.woff2) format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOUehpKKSTj5PW.woff2) format('woff2');unicode-range:U+0370-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOXehpKKSTj5PW.woff2) format('woff2');unicode-range:U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOXOhpKKSTj5PW.woff2) format('woff2');unicode-range:U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOUuhpKKSTjw.woff2) format('woff2');unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}</style>
  <link rel="stylesheet" href="styles.9bac479871542abb4809.css"><style>[_nghost-qpq-c89], app-root-scully[_ngcontent-qpq-c89] { display: block; height: 100% }</style><meta name="keywords" content="Desnote Book, Github, Desnoust, Nicolas, Spring, Java, JEE"><meta name="description" content="Notes personnelles portant sur différentes technologies du web : Java, Jakarta EE, Spring, HTML, SCSS, ..."><meta name="robots" content="index, follow"><script charset="utf-8" src="common-es2015.e3c414be0de2a20381ce.js"></script><script charset="utf-8" src="6-es2015.5c84f9e3bd9d3fcce144.js"></script><style>.main-layout-container[_ngcontent-qpq-c87]{min-height:100vh}.main-layout-container[_ngcontent-qpq-c87]   .navbar[_ngcontent-qpq-c87]{height:50px;position:-webkit-sticky;position:sticky;top:0;left:0;z-index:3;display:flex;width:100%;padding:0}@media screen and (min-width:960px){.main-layout-container[_ngcontent-qpq-c87]   .navbar[_ngcontent-qpq-c87]{box-shadow:unset}}.main-layout-container[_ngcontent-qpq-c87]   .sub-header[_ngcontent-qpq-c87]{display:flex;top:50px;position:fixed;height:40px;z-index:2}@media screen and (max-width:960px){.main-layout-container[_ngcontent-qpq-c87]   .sub-header[_ngcontent-qpq-c87]{display:none}}.main-layout-container[_ngcontent-qpq-c87]   .cd-auto-hide-header[_ngcontent-qpq-c87]{position:fixed;left:0;width:100%;transition:transform .4s ease}.main-layout-container[_ngcontent-qpq-c87]   .cd-auto-hide-header.is-hidden[_ngcontent-qpq-c87]{transform:translate3d(0,-101%,0)!important}.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav[_ngcontent-qpq-c87]{width:268px;top:50px;position:fixed;display:block;height:100%;will-change:transform}.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav[_ngcontent-qpq-c87]     .mat-drawer-inner-container{display:flex}.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav[_ngcontent-qpq-c87]     .mat-drawer-inner-container app-left-sidenav, .mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav[_ngcontent-qpq-c87]     .mat-drawer-inner-container app-table-of-contents{transition:all .4s ease}@media screen and (min-width:960px){.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav[_ngcontent-qpq-c87]     .mat-drawer-inner-container app-left-sidenav, .mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav[_ngcontent-qpq-c87]     .mat-drawer-inner-container app-table-of-contents{padding-top:40px}}@media screen and (min-width:960px){.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav.without-sub-navbar[_ngcontent-qpq-c87]     .mat-drawer-inner-container app-left-sidenav, .mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav.without-sub-navbar[_ngcontent-qpq-c87]     .mat-drawer-inner-container app-table-of-contents{transform:translate3d(0,-40px,0)!important}}@media screen and (max-width:960px){.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav.scully-running[_ngcontent-qpq-c87]{transform:translate3d(-100%,0,0)!important}}.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav.left-sidenav[_ngcontent-qpq-c87]{border:0}.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav.right-sidenav[_ngcontent-qpq-c87]{background-color:inherit;border:none}@media screen and (max-width:1254px){.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav.right-sidenav[_ngcontent-qpq-c87]{transform:translate3d(100%,0,0)!important}}.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav.right-sidenav[_ngcontent-qpq-c87]   .external-toc[_ngcontent-qpq-c87]{margin:2rem 2rem 2rem 0}.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav-content[_ngcontent-qpq-c87]{top:0;width:100%;display:flex;align-content:center;justify-content:center;margin:40px 268px 0;padding:1.5rem}@media screen and (max-width:1254px){.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav-content[_ngcontent-qpq-c87]{margin-right:0!important}}@media screen and (max-width:960px){.mat-sidenav-container[_ngcontent-qpq-c87]   .mat-sidenav-content[_ngcontent-qpq-c87]{margin:0!important;padding:0!important}}.main-content-wrapper[_ngcontent-qpq-c87]{padding:0;width:100%;max-width:960px}.main-content-wrapper[_ngcontent-qpq-c87]   .main-content[_ngcontent-qpq-c87]{min-height:100vh}</style><style>.navbar-toolbar[_ngcontent-qpq-c58]{display:flex;width:100%;height:100%}.navbar-toolbar--transparent[_ngcontent-qpq-c58]{background-color:transparent!important;border:none!important}.navbar-toolbar[_ngcontent-qpq-c58]   .hamburger-button-container[_ngcontent-qpq-c58]{display:flex;align-items:center}@media screen and (min-width:960px){.navbar-toolbar[_ngcontent-qpq-c58]   .hamburger-button-container[_ngcontent-qpq-c58]{display:none}}.navbar-toolbar[_ngcontent-qpq-c58]   .branding[_ngcontent-qpq-c58]{display:flex;justify-content:center;align-items:center}.navbar-toolbar[_ngcontent-qpq-c58]   .branding[_ngcontent-qpq-c58]   a[_ngcontent-qpq-c58]{background:none;font-size:smaller;text-decoration:none;font-size:14px}.navbar-toolbar[_ngcontent-qpq-c58]   .spacer[_ngcontent-qpq-c58]{flex:1 0 auto}.navbar-toolbar[_ngcontent-qpq-c58]     .mat-button-wrapper{display:flex;justify-content:center}.navbar-toolbar[_ngcontent-qpq-c58]     .mat-button-wrapper i-feather{width:1.2rem}.navbar-toolbar[_ngcontent-qpq-c58]     .mat-button-wrapper i-feather svg{stroke-width:2px;padding-top:2px;vertical-align:super}</style><style>.sub-navbar[_ngcontent-qpq-c59]{height:inherit}.sub-navbar-link[_ngcontent-qpq-c59]{font-weight:600;letter-spacing:.05rem;text-transform:uppercase;font-size:11px}</style><style>.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}
</style><style>[_nghost-qpq-c79]{display:flex;flex-direction:column;overflow-y:hidden}.mat-nav-list[_ngcontent-qpq-c79]{padding-top:0;overflow-y:auto}.mat-expansion-panel[_ngcontent-qpq-c79]{border-radius:0;border-bottom:1px solid #dadce0}.mat-expansion-panel-header-title[_ngcontent-qpq-c79]{font-weight:600;text-transform:uppercase;font-size:smaller;letter-spacing:.05rem;font-size:11px}.mat-expansion-panel-body[_ngcontent-qpq-c79]{padding-top:.5rem}.mat-list-item[_ngcontent-qpq-c79]{padding:.3rem 0 .3rem .3rem;border-radius:0;height:auto!important;padding:.5rem 0!important}.mat-list-item[_ngcontent-qpq-c79]:first-of-type{margin-top:.5rem;border-top-left-radius:.3rem;border-top-right-radius:.3rem}.mat-list-item[_ngcontent-qpq-c79]:last-of-type{border-bottom-left-radius:.3rem;border-bottom-right-radius:.3rem}.mat-list-item[_ngcontent-qpq-c79]   span[_ngcontent-qpq-c79]{font-size:smaller;white-space:normal;text-overflow:clip}.mat-list-item[_ngcontent-qpq-c79]:hover{text-decoration:none}</style><style>[_nghost-qpq-c86]{display:flex;flex-direction:column;overflow-y:hidden}.toc[_ngcontent-qpq-c86]{overflow-y:auto;padding-left:12px;border-left-width:4px;border-left-style:solid}.toc__title[_ngcontent-qpq-c86]{margin-bottom:.5em}.toc__title[_ngcontent-qpq-c86]   span[_ngcontent-qpq-c86]{font-weight:600;font-size:15px}.toc__expand-button[_ngcontent-qpq-c86]{display:flex;justify-content:center;align-items:center}.toc__nav[_ngcontent-qpq-c86]   ul[_ngcontent-qpq-c86]{padding:0;margin-bottom:.5rem;list-style-type:none}.toc__nav[_ngcontent-qpq-c86]   ul[_ngcontent-qpq-c86]   li[_ngcontent-qpq-c86]{margin-top:.25rem;font-size:14px}.toc__nav[_ngcontent-qpq-c86]   ul[_ngcontent-qpq-c86]   li.li--for-h3[_ngcontent-qpq-c86]{text-indent:.25in}.toc__nav[_ngcontent-qpq-c86]   ul[_ngcontent-qpq-c86]   li[_ngcontent-qpq-c86]   a[_ngcontent-qpq-c86]:hover{text-decoration:none}</style><style>.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}.mat-toolbar-multiple-rows{min-height:64px}.mat-toolbar-row,.mat-toolbar-single-row{height:64px}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:56px}.mat-toolbar-row,.mat-toolbar-single-row{height:56px}}
</style><style>.mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled],.mat-flat-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}
</style><style>[_nghost-qpq-c30]{display:inline-block;fill:none;height:24px;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px;width:24px}</style><style>.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0;position:relative}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}
</style><style>table+p{margin-top:1.5rem!important}  .main-blog .blog-content markdown>:nth-child(5){padding-top:1rem!important;margin-top:0!important}a[_ngcontent-qpq-c112]{color:inherit!important}.btn[_ngcontent-qpq-c112]{margin-bottom:0;border-radius:0}.spacer[_ngcontent-qpq-c112]{flex:1 0 auto}h1[_ngcontent-qpq-c112]{margin-bottom:0!important}  .share__menu i-feather{width:16.333px;height:auto}  .share__menu i-feather svg{stroke-width:2px}.post__subheader[_ngcontent-qpq-c112]{color:#8b949e;display:flex;align-items:center;margin-bottom:1rem}.post__subheader[_ngcontent-qpq-c112]     .clock svg{width:1rem;vertical-align:bottom;stroke-width:2px}.post__subheader[_ngcontent-qpq-c112]   span[_ngcontent-qpq-c112]{display:flex;align-items:center}.post__subheader[_ngcontent-qpq-c112]     svg{stroke-width:1.5px;width:1.3rem}  .main-blog{padding:2rem;font-size:15px}  .main-blog .inner-toc{margin:0 2em 0 0}@media screen and (min-width:1254px){  .main-blog .inner-toc{display:none}}  .main-blog   .blog-content markdown>:first-child,   .main-blog   .blog-content markdown>:nth-child(2),   .main-blog   .blog-content markdown>:nth-child(3){display:none}@media screen and (min-width:600px){  .main-blog   .blog-content markdown pre{padding-top:0!important}}@media screen and (max-width:600px){  .main-blog   .blog-content markdown .code-header{border-radius:4px 0 0 0}  .main-blog   .blog-content markdown div[id^=code-]{border-radius:0 0 0 4px}  .main-blog   .blog-content markdown>.code-header,   .main-blog   .blog-content markdown>.code-header>pre,   .main-blog   .blog-content markdown>div[id^=code-],   .main-blog   .blog-content markdown>div[id^=code-]>pre{border-radius:0}  .main-blog   .blog-content markdown .code-header,   .main-blog   .blog-content markdown div[id^=code-]{margin-left:-2rem;margin-right:-2rem}  .main-blog   .blog-content markdown div[id^=code-]>pre{border:0;padding-top:0;padding-left:2rem;padding-right:2rem}}  .main-blog   .blog-content div.toc{margin-bottom:0;margin-left:0}  .main-blog   .blog-content .token.class-name{text-decoration:none}  .main-blog   .blog-content h1{display:none}  .main-blog   .blog-content h2{padding-top:1rem}  .main-blog   .blog-content>pre{border:0;border-radius:0 0 4px 4px;padding:.5rem 1.5em 2em}  .main-blog   .blog-content>pre>code{padding-right:1em}  .main-blog   .blog-content .code-header{display:flex;justify-content:flex-end;border-radius:4px 4px 0 0}  .main-blog   .blog-content .code-header .btn{border:0;margin:.3em .5em 0 .3em;padding:0;font-size:1.2em;width:auto}  .main-blog   .blog-content .code-header .btn i{color:#94969b}  .main-blog   .blog-content .code-header .btn i:hover{color:#fff}  .main-blog   .blog-content code{padding:2px 4px;font-family:Fira Code,Consolas,Liberation Mono,Menlo,Courier,monospace;border-radius:.3rem}  .main-blog   .blog-content pre{padding:.8rem;margin-top:0;margin-bottom:1rem;font:1rem Fira Code,Consolas,Liberation Mono,Menlo,Courier,monospace;word-wrap:normal;border-radius:0 0 .3rem .3rem}  .main-blog   .blog-content pre:before{content:attr(class);position:absolute;display:block;margin-bottom:6px;font-size:10px;font-weight:500;text-indent:-5rem;text-transform:uppercase;letter-spacing:2px;overflow:hidden;color:hsla(0,0%,91.4%,.7686274509803922);transform:translateY(-22px) translateX(0)}@media screen and (max-width:600px){  .main-blog   .blog-content pre:before{transform:translateY(-22px) translateX(-25px)}}  .main-blog   .blog-content pre>code{padding:0;margin:0;font-size:.9rem;word-break:normal;white-space:pre;background:transparent;border:0;border-radius:0 0 .3rem .3rem}  .main-blog   .blog-content .highlight{margin-bottom:1rem}  .main-blog   .blog-content .highlight pre{margin-bottom:0;word-break:normal}  .main-blog   .blog-content .highlight pre,   .main-blog   .blog-content pre{padding:.8rem;overflow:auto;font-size:.9rem;line-height:1.45;border-radius:0 0 .3rem .3rem;-webkit-overflow-scrolling:touch}  .main-blog   .blog-content pre code,   .main-blog   .blog-content pre tt{display:inline;max-width:none;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}  .main-blog   .blog-content pre code:after,   .main-blog   .blog-content pre code:before,   .main-blog   .blog-content pre tt:after,   .main-blog   .blog-content pre tt:before{content:normal}</style><style>.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:4px;outline:0;min-height:64px}.mat-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-menu-panel{outline:solid 1px}.mat-menu-content:not(:empty){padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative}.mat-menu-item::-moz-focus-inner{border:0}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item[disabled]{pointer-events:none}.cdk-high-contrast-active .mat-menu-item.cdk-program-focused,.cdk-high-contrast-active .mat-menu-item.cdk-keyboard-focused,.cdk-high-contrast-active .mat-menu-item-highlighted{outline:dotted 1px}.mat-menu-item-submenu-trigger{padding-right:32px}.mat-menu-item-submenu-trigger::after{width:0;height:0;border-style:solid;border-width:5px 0 5px 5px;border-color:transparent transparent transparent currentColor;content:"";display:inline-block;position:absolute;top:50%;right:16px;transform:translateY(-50%)}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}[dir=rtl] .mat-menu-item-submenu-trigger::after{right:auto;left:16px;transform:rotateY(180deg) translateY(-50%)}button.mat-menu-item{width:100%}.mat-menu-item .mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}
</style><style>.copy-button[_ngcontent-qpq-c108] {
      border: 0;
      margin: 0;
      padding: 0;
      font-size: 1.2em;
      width: auto;
      background-color: transparent;
    }</style><style>
      :host {
        display: none;
      }
      scully-content {
        display: none;
      }
    </style><style>.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row button.mat-button-base,.mat-action-row button.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row button.mat-button-base,[dir=rtl] .mat-action-row button.mat-mdc-button-base{margin-left:0;margin-right:8px}
</style><style>.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;position:relative}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;margin-right:16px}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}
</style><script>window['ScullyIO']='generated';</script>
<script type="text/javascript" id="scully-plugin-discount-flash-prevention">
  function capt (ev) {
	  if (document.documentElement.scrollTop === 0) {
	  	document.documentElement.scrollTop = window['ScullyIO-scrollPosition'];
	  }
	  window['ScullyIO-scrollPosition'] = document.documentElement.scrollTop;
	  document.addEventListener("AngularReady", detach);
	};

  function detach() {
		window.removeEventListener('scroll', capt);
		document.removeEventListener("AngularReady", detach);
  };

	window.addEventListener('scroll', capt);

	window.addEventListener('AngularReady', scullyDiscountFlashPreventionContentScript);
	function scullyDiscountFlashPreventionContentScript(){
	  document.documentElement.scrollTop = window['ScullyIO-scrollPosition'];
	  window.removeEventListener('scroll', capt);
		document.body.classList.add('loaded');
		const tempAppRoot = document.querySelector('app-root-scully');
    tempAppRoot.parentNode.removeChild(tempAppRoot);
    window.removeEventListener('AngularReady', scullyDiscountFlashPreventionContentScript);
    window.dispatchEvent(new Event('FlashPreventionSwitchDone', {
      bubbles: true,
      cancelable: false
    }))
	}
</script>
<style type="text/css">
	body:not(.loaded) app-root { display:none; }
	body:not(.loaded) app-root-scully { display:inherit; }
	body.loaded app-root { display:inherit; }
  body.loaded app-root-scully { display:none; }
</style>
</head>
  <body class="mat-typography mat-app-background light-theme" scully-version="1.1.0"><script>
      const theme = localStorage.getItem('theme');

      if (theme === 'light' || theme === 'dark') {
        const bodyClassList = document.querySelector('body').classList;
        const removeClassList = /\w*-theme\b/.exec(bodyClassList.value);
        if (removeClassList) {
          bodyClassList.remove(...removeClassList);
        }
        bodyClassList.add(theme + '-theme');
      }
    </script>
    <app-root></app-root><app-root-scully _nghost-qpq-c89="" ng-version="9.0.7"><router-outlet _ngcontent-qpq-c89=""></router-outlet><app-main-layout _nghost-qpq-c87="" class="ng-star-inserted"><div _ngcontent-qpq-c87="" class="main-layout-container"><app-navbar _ngcontent-qpq-c87="" class="navbar mat-elevation-z1" _nghost-qpq-c58=""><mat-toolbar _ngcontent-qpq-c58="" class="mat-toolbar navbar-toolbar mat-toolbar-single-row"><div _ngcontent-qpq-c58="" class="hamburger-button-container ng-star-inserted"><button _ngcontent-qpq-c58="" mat-icon-button="" class="mat-focus-indicator mat-icon-button mat-button-base"><span class="mat-button-wrapper"><i-feather _ngcontent-qpq-c58="" name="menu" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
</svg></i-feather></span><div matripple="" class="mat-ripple mat-button-ripple mat-button-ripple-round"></div><div class="mat-button-focus-overlay"></div></button></div><!----><div _ngcontent-qpq-c58="" class="branding ng-star-inserted"><a _ngcontent-qpq-c58="" mat-flat-button="" routerlink="/" class="mat-focus-indicator mat-flat-button mat-button-base" tabindex="0" aria-disabled="false" href="/"><span class="mat-button-wrapper">Desnote Book</span><div matripple="" class="mat-ripple mat-button-ripple"></div><div class="mat-button-focus-overlay"></div></a></div><!----><span _ngcontent-qpq-c58="" class="spacer"></span><!----><button _ngcontent-qpq-c58="" mat-icon-button="" class="mat-focus-indicator mat-icon-button mat-button-base"><span class="mat-button-wrapper"><i-feather _ngcontent-qpq-c58="" name="search" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
</svg></i-feather></span><div matripple="" class="mat-ripple mat-button-ripple mat-button-ripple-round"></div><div class="mat-button-focus-overlay"></div></button><button _ngcontent-qpq-c58="" mat-icon-button="" class="mat-focus-indicator mat-icon-button mat-button-base"><span class="mat-button-wrapper"><i-feather _ngcontent-qpq-c58="" name="maximize" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-maximize">
    <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
</svg></i-feather></span><div matripple="" class="mat-ripple mat-button-ripple mat-button-ripple-round"></div><div class="mat-button-focus-overlay"></div></button><button _ngcontent-qpq-c58="" mat-icon-button="" class="mat-focus-indicator mat-icon-button mat-button-base"><span class="mat-button-wrapper"><i-feather _ngcontent-qpq-c58="" name="moon" _nghost-qpq-c30="" class="ng-star-inserted"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-moon">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
</svg></i-feather><!----><!----></span><div matripple="" class="mat-ripple mat-button-ripple mat-button-ripple-round"></div><div class="mat-button-focus-overlay"></div></button></mat-toolbar></app-navbar><app-sub-header _ngcontent-qpq-c87="" class="sub-header cd-auto-hide-header" _nghost-qpq-c59=""><mat-toolbar _ngcontent-qpq-c59="" color="primary" class="mat-toolbar sub-navbar mat-elevation-z1 mat-primary mat-toolbar-single-row"><a _ngcontent-qpq-c59="" mat-button="" routerlinkactive="" disabled="true" class="mat-focus-indicator sub-navbar-link mat-button mat-button-base ng-star-inserted" style="pointer-events: none; cursor: default;" tabindex="-1" aria-disabled="true" href="/blog"><span class="mat-button-wrapper"> Tutoriels </span><div matripple="" class="mat-ripple mat-button-ripple"></div><div class="mat-button-focus-overlay"></div></a><a _ngcontent-qpq-c59="" mat-button="" routerlinkactive="" disabled="true" class="mat-focus-indicator sub-navbar-link mat-button mat-button-base ng-star-inserted" style="pointer-events: none; cursor: default;" tabindex="-1" aria-disabled="true" href="/cheet-sheets"><span class="mat-button-wrapper"> Cheet Sheets </span><div matripple="" class="mat-ripple mat-button-ripple"></div><div class="mat-button-focus-overlay"></div></a><a _ngcontent-qpq-c59="" mat-button="" routerlinkactive="" disabled="true" class="mat-focus-indicator sub-navbar-link mat-button mat-button-base ng-star-inserted" style="pointer-events: none; cursor: default;" tabindex="-1" aria-disabled="true" href="/courses"><span class="mat-button-wrapper"> Cours </span><div matripple="" class="mat-ripple mat-button-ripple"></div><div class="mat-button-focus-overlay"></div></a><!----></mat-toolbar></app-sub-header><mat-sidenav-container _ngcontent-qpq-c87="" class="mat-drawer-container mat-sidenav-container d-flex"><!----><div class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"></div><mat-sidenav _ngcontent-qpq-c87="" tabindex="-1" class="mat-drawer mat-sidenav left-sidenav mat-elevation-z2 ng-tns-c64-0 ng-trigger ng-trigger-transform scully-running mat-drawer-side mat-drawer-opened ng-star-inserted" style="transform: none; visibility: visible;"><div class="mat-drawer-inner-container ng-tns-c64-0"><app-left-sidenav _ngcontent-qpq-c87="" _nghost-qpq-c79="" class="ng-tns-c64-0"><mat-nav-list _ngcontent-qpq-c79="" role="navigation" class="mat-nav-list mat-list-base"><!----><!----><!----><!----><mat-expansion-panel _ngcontent-qpq-c79="" routerlinkactive="" class="mat-expansion-panel mat-elevation-z0 ng-tns-c76-3 ng-star-inserted" style=""><mat-expansion-panel-header _ngcontent-qpq-c79="" role="button" class="mat-expansion-panel-header mat-focus-indicator ng-tns-c77-4 ng-trigger ng-trigger-expansionHeight ng-tns-c76-3 ng-star-inserted" id="mat-expansion-panel-header-0" tabindex="0" aria-controls="cdk-accordion-child-0" aria-expanded="false" aria-disabled="false" style="height: 48px;"><span class="mat-content ng-tns-c77-4"><mat-panel-title _ngcontent-qpq-c79="" class="mat-expansion-panel-header-title ng-tns-c77-4"> Javascript </mat-panel-title></span><span class="mat-expansion-indicator ng-tns-c77-4 ng-trigger ng-trigger-indicatorRotate ng-star-inserted" style="transform: rotate(0deg);"></span><!----></mat-expansion-panel-header><div role="region" class="mat-expansion-panel-content ng-tns-c76-3 ng-trigger ng-trigger-bodyExpansion" id="cdk-accordion-child-0" aria-labelledby="mat-expansion-panel-header-0" style="height: 0px; visibility: hidden;"><div class="mat-expansion-panel-body ng-tns-c76-3"><a _ngcontent-qpq-c79="" mat-list-item="" matripple="" routerlinkactive="active-link" class="mat-list-item mat-focus-indicator mat-ripple ng-star-inserted" href="/blog/2021-04-20-memento-javascript" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"><span _ngcontent-qpq-c79="" matline="" class="mat-line">Mémento des concepts du langage Javascript</span></div></div></a><!----><!----></div></div></mat-expansion-panel><!----><!----><!----><!----><!----><!----><!----><mat-expansion-panel _ngcontent-qpq-c79="" routerlinkactive="" class="mat-expansion-panel mat-elevation-z0 ng-tns-c76-5 ng-star-inserted" style=""><mat-expansion-panel-header _ngcontent-qpq-c79="" role="button" class="mat-expansion-panel-header mat-focus-indicator ng-tns-c77-6 ng-trigger ng-trigger-expansionHeight ng-tns-c76-5 ng-star-inserted" id="mat-expansion-panel-header-1" tabindex="0" aria-controls="cdk-accordion-child-1" aria-expanded="false" aria-disabled="false" style="height: 48px;"><span class="mat-content ng-tns-c77-6"><mat-panel-title _ngcontent-qpq-c79="" class="mat-expansion-panel-header-title ng-tns-c77-6"> CSS </mat-panel-title></span><span class="mat-expansion-indicator ng-tns-c77-6 ng-trigger ng-trigger-indicatorRotate ng-star-inserted" style="transform: rotate(0deg);"></span><!----></mat-expansion-panel-header><div role="region" class="mat-expansion-panel-content ng-tns-c76-5 ng-trigger ng-trigger-bodyExpansion" id="cdk-accordion-child-1" aria-labelledby="mat-expansion-panel-header-1" style="height: 0px; visibility: hidden;"><div class="mat-expansion-panel-body ng-tns-c76-5"><a _ngcontent-qpq-c79="" mat-list-item="" matripple="" routerlinkactive="active-link" class="mat-list-item mat-focus-indicator mat-ripple ng-star-inserted" href="/blog/2020-07-05-comment-rendre-son-footer-responsive-en-css" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"><span _ngcontent-qpq-c79="" matline="" class="mat-line">Comment rendre son footer responsive en CSS ?</span></div></div></a><a _ngcontent-qpq-c79="" mat-list-item="" matripple="" routerlinkactive="active-link" class="mat-list-item mat-focus-indicator mat-ripple ng-star-inserted" href="/blog/2021-03-04-memento-proprietes-css" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"><span _ngcontent-qpq-c79="" matline="" class="mat-line">Mémento des propriétés CSS</span></div></div></a><!----><!----></div></div></mat-expansion-panel><!----><!----><!----><mat-expansion-panel _ngcontent-qpq-c79="" routerlinkactive="" class="mat-expansion-panel mat-elevation-z0 ng-tns-c76-7 ng-star-inserted" style=""><mat-expansion-panel-header _ngcontent-qpq-c79="" role="button" class="mat-expansion-panel-header mat-focus-indicator ng-tns-c77-8 ng-trigger ng-trigger-expansionHeight ng-tns-c76-7 ng-star-inserted" id="mat-expansion-panel-header-2" tabindex="0" aria-controls="cdk-accordion-child-2" aria-expanded="false" aria-disabled="false" style="height: 48px;"><span class="mat-content ng-tns-c77-8"><mat-panel-title _ngcontent-qpq-c79="" class="mat-expansion-panel-header-title ng-tns-c77-8"> HTML </mat-panel-title></span><span class="mat-expansion-indicator ng-tns-c77-8 ng-trigger ng-trigger-indicatorRotate ng-star-inserted" style="transform: rotate(0deg);"></span><!----></mat-expansion-panel-header><div role="region" class="mat-expansion-panel-content ng-tns-c76-7 ng-trigger ng-trigger-bodyExpansion" id="cdk-accordion-child-2" aria-labelledby="mat-expansion-panel-header-2" style="height: 0px; visibility: hidden;"><div class="mat-expansion-panel-body ng-tns-c76-7"><a _ngcontent-qpq-c79="" mat-list-item="" matripple="" routerlinkactive="active-link" class="mat-list-item mat-focus-indicator mat-ripple ng-star-inserted" href="/blog/2021-03-04-memento-balises-html" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"><span _ngcontent-qpq-c79="" matline="" class="mat-line">Mémento des balises HTML</span></div></div></a><!----><!----></div></div></mat-expansion-panel><!----><!----><!----><mat-expansion-panel _ngcontent-qpq-c79="" routerlinkactive="" class="mat-expansion-panel mat-elevation-z0 ng-tns-c76-9 ng-star-inserted mat-expanded" style=""><mat-expansion-panel-header _ngcontent-qpq-c79="" role="button" class="mat-expansion-panel-header mat-focus-indicator ng-tns-c77-10 ng-trigger ng-trigger-expansionHeight ng-tns-c76-9 ng-star-inserted mat-expanded" id="mat-expansion-panel-header-3" tabindex="0" aria-controls="cdk-accordion-child-3" aria-expanded="true" aria-disabled="false" style="height: 64px;"><span class="mat-content ng-tns-c77-10"><mat-panel-title _ngcontent-qpq-c79="" class="mat-expansion-panel-header-title ng-tns-c77-10"> Spring </mat-panel-title></span><span class="mat-expansion-indicator ng-tns-c77-10 ng-trigger ng-trigger-indicatorRotate ng-star-inserted" style="transform: rotate(180deg);"></span><!----></mat-expansion-panel-header><div role="region" class="mat-expansion-panel-content ng-tns-c76-9 ng-trigger ng-trigger-bodyExpansion" id="cdk-accordion-child-3" aria-labelledby="mat-expansion-panel-header-3" style="visibility: visible;"><div class="mat-expansion-panel-body ng-tns-c76-9"><a _ngcontent-qpq-c79="" mat-list-item="" matripple="" routerlinkactive="active-link" class="mat-list-item mat-focus-indicator mat-ripple ng-star-inserted" href="/blog/2020-07-05-dev-api-rest-avec-spring" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"><span _ngcontent-qpq-c79="" matline="" class="mat-line">Développement d'une API REST avec Spring</span></div></div></a><a _ngcontent-qpq-c79="" mat-list-item="" matripple="" routerlinkactive="active-link" class="mat-list-item mat-focus-indicator mat-ripple ng-star-inserted active-link" href="/blog/2020-10-23-introduction-spring" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"><span _ngcontent-qpq-c79="" matline="" class="mat-line">Petite introduction à Spring</span></div></div></a><!----><!----></div></div></mat-expansion-panel><!----><!----><!----><!----><!----><mat-expansion-panel _ngcontent-qpq-c79="" routerlinkactive="" class="mat-expansion-panel mat-elevation-z0 ng-tns-c76-11 ng-star-inserted" style=""><mat-expansion-panel-header _ngcontent-qpq-c79="" role="button" class="mat-expansion-panel-header mat-focus-indicator ng-tns-c77-12 ng-trigger ng-trigger-expansionHeight ng-tns-c76-11 ng-star-inserted" id="mat-expansion-panel-header-4" tabindex="0" aria-controls="cdk-accordion-child-4" aria-expanded="false" aria-disabled="false" style="height: 48px;"><span class="mat-content ng-tns-c77-12"><mat-panel-title _ngcontent-qpq-c79="" class="mat-expansion-panel-header-title ng-tns-c77-12"> Visual Studio Code </mat-panel-title></span><span class="mat-expansion-indicator ng-tns-c77-12 ng-trigger ng-trigger-indicatorRotate ng-star-inserted" style="transform: rotate(0deg);"></span><!----></mat-expansion-panel-header><div role="region" class="mat-expansion-panel-content ng-tns-c76-11 ng-trigger ng-trigger-bodyExpansion" id="cdk-accordion-child-4" aria-labelledby="mat-expansion-panel-header-4" style="height: 0px; visibility: hidden;"><div class="mat-expansion-panel-body ng-tns-c76-11"><a _ngcontent-qpq-c79="" mat-list-item="" matripple="" routerlinkactive="active-link" class="mat-list-item mat-focus-indicator mat-ripple ng-star-inserted" href="/blog/2020-10-08-setup-vscode" style=""><div class="mat-list-item-content"><div mat-ripple="" class="mat-ripple mat-list-item-ripple"></div><div class="mat-list-text"><span _ngcontent-qpq-c79="" matline="" class="mat-line">Setup de Visual Studio Code</span></div></div></a><!----><!----></div></div></mat-expansion-panel><!----><!----><!----><!----><!----><!----></mat-nav-list></app-left-sidenav></div></mat-sidenav><div class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"></div><div class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"></div><mat-sidenav _ngcontent-qpq-c87="" tabindex="-1" mode="side" position="end" opened="" class="mat-drawer mat-sidenav mat-elevation-z0 right-sidenav with-sub-navbar-visible ng-tns-c64-1 ng-trigger ng-trigger-transform mat-drawer-end mat-drawer-side mat-drawer-opened ng-star-inserted" style="transform: none; visibility: visible;"><div class="mat-drawer-inner-container ng-tns-c64-1"><app-table-of-contents _ngcontent-qpq-c87="" class="external-toc ng-tns-c64-1" _nghost-qpq-c86=""><div _ngcontent-qpq-c86="" class="toc ng-star-inserted" style=""><div _ngcontent-qpq-c86="" class="toc__title"><span _ngcontent-qpq-c86="">Sommaire</span></div><nav _ngcontent-qpq-c86="" class="toc__nav"><ul _ngcontent-qpq-c86=""><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#introduction"> Introduction </a></li><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#programmation-par-contrat"> Programmation par contrat </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#principe"> Principe </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#sp%C3%A9cifier-un-service-logiciel"> Spécifier un service logiciel </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#une-premi%C3%A8re-implantation"> Une première implantation </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#une-deuxi%C3%A8me-implantation"> Une deuxième implantation </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#une-troisi%C3%A8me-implantation"> Une troisième implantation </a></li><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#injection-des-d%C3%A9pendances"> Injection des dépendances </a></li><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#gestion-des-beans-par-spring"> Gestion des beans par Spring </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#installation-de-spring"> Installation de Spring </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#callbacks-par-annotations"> Callbacks par annotations </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#cr%C3%A9er-et-utiliser-des-javabeans"> Créer et utiliser des javaBeans </a></li><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#utilisez-les-annotations-de-spring"> Utilisez les annotations de Spring </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#injection-par-annotation"> Injection par annotation </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#d%C3%A9clarer-les-services-par-annotation"> Déclarer les services par annotation </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#contr%C3%B4ler-les-implantations-choisies"> Contrôler les implantations choisies </a></li><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#int%C3%A9gration-junit-spring"> Intégration JUnit / Spring </a></li><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#configurer-en-java"> Configurer en Java </a></li><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#nouvelles-implantations"> Nouvelles implantations </a></li><!----></ul></nav><!----></div><!----><!----></app-table-of-contents></div></mat-sidenav><div class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"></div><mat-sidenav-content _ngcontent-qpq-c87="" class="mat-drawer-content mat-sidenav-content with-sub-navbar-visible p-4" style="margin-left: 268px; margin-right: 268px;"><div _ngcontent-qpq-c87="" role="main" addcodeheaders="" class="main-content-wrapper"><main _ngcontent-qpq-c87="" class="main-content"><router-outlet _ngcontent-qpq-c87=""></router-outlet><app-blog _nghost-qpq-c112="" class="ng-star-inserted"><div _ngcontent-qpq-c112="" class="main-blog">
  <h1 _ngcontent-qpq-c112="">Petite introduction à Spring</h1>

  <div _ngcontent-qpq-c112="" class="post__subheader">
    <i-feather _ngcontent-qpq-c112="" name="clock" class="clock" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-clock">
    <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg></i-feather>
    <span _ngcontent-qpq-c112="">23 oct. 2020</span>
    <span _ngcontent-qpq-c112="" class="ml-2 mr-2">·</span>
    <span _ngcontent-qpq-c112="">
      17 min. de lecture
    </span>
    <span _ngcontent-qpq-c112="" class="spacer"></span>
    <button _ngcontent-qpq-c112="" aria-haspopup="true" mat-icon-button="" mattooltip="Partager le post" class="mat-focus-indicator mat-menu-trigger mat-icon-button mat-button-base" aria-describedby="cdk-describedby-message-0" cdk-describedby-host=""><span class="mat-button-wrapper">
      <i-feather _ngcontent-qpq-c112="" name="share" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-share">
    <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line>
</svg></i-feather>
    </span><div matripple="" class="mat-ripple mat-button-ripple mat-button-ripple-round"></div><div class="mat-button-focus-overlay"></div></button><!---->
    <mat-menu _ngcontent-qpq-c112="" class=""><!----></mat-menu>
  </div>

  <div _ngcontent-qpq-c112="" class="inner-toc">
    <app-table-of-contents _ngcontent-qpq-c112="" limit="5" _nghost-qpq-c86=""><div _ngcontent-qpq-c86="" class="toc ng-star-inserted"><div _ngcontent-qpq-c86="" class="toc__title"><span _ngcontent-qpq-c86="">Sommaire</span></div><nav _ngcontent-qpq-c86="" class="toc__nav"><ul _ngcontent-qpq-c86=""><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#introduction"> Introduction </a></li><li _ngcontent-qpq-c86="" class="li--for-h2 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#programmation-par-contrat"> Programmation par contrat </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#principe"> Principe </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#sp%C3%A9cifier-un-service-logiciel"> Spécifier un service logiciel </a></li><li _ngcontent-qpq-c86="" class="li--for-h3 ng-star-inserted"><a _ngcontent-qpq-c86="" routerlink="." routerlinkactive="" href="/blog/2020-10-23-introduction-spring#une-premi%C3%A8re-implantation"> Une première implantation </a></li><!----></ul></nav><button _ngcontent-qpq-c86="" mat-icon-button="" aria-label="Expand button" class="mat-focus-indicator toc__expand-button mat-icon-button mat-button-base ng-star-inserted"><span class="mat-button-wrapper"><i-feather _ngcontent-qpq-c86="" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-more-horizontal">
    <circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle>
</svg></i-feather></span><div matripple="" class="mat-ripple mat-button-ripple mat-button-ripple-round"></div><div class="mat-button-focus-overlay"></div></button><!----></div><!----><!----></app-table-of-contents>
  </div>

  
  <div _ngcontent-qpq-c112="" class="blog-content">
    <markdown _ngcontent-qpq-c112="" emoji="" testdir="" addcodeheaders=""><hr>
<p>title: 'Petite introduction à Spring'
description: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.'
published: true
category: 'spring'
createdAt: '2020-10-23'</p>
<hr>

    <h1 id="une-petite-introduction-à-spring">Une (petite) introduction à Spring
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#une-petite-introduction-à-spring" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h1>
    
    <h2 id="introduction">Introduction
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#introduction" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h2>
    <p>Le framework <a href="http://www.springframework.org/">Spring</a> est une boite à outils très riche permettant de structurer, d'améliorer et de simplifier l'écriture d'application JEE. Spring est organisé en module :</p>
<ul>
<li>Gestion des instances de classes (JavaBean et/ou métier),</li>
<li>Programmation orientée Aspect,</li>
<li>Modèle MVC et outils pour les applications WEB,</li>
<li>Outils pour la DAO (JDBC),</li>
<li>Outils pour les ORM (Hibernate, iBatis, ...),</li>
<li>Outils pour les applications JEE (JMX, JMA, JCA, EJB, ...).</li>
</ul>
<p><a href="https://docs.spring.io/spring/docs/5.2.x/spring-framework-reference/overview.html">Plus d'informations ici</a>.</p>

    <h2 id="programmation-par-contrat">Programmation par contrat
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#programmation-par-contrat" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h2>
    <p>Travail à faire :</p>
<ul>
<li>Lancez Eclipse JEE (commande eclipse). Si la commande n'est pas disponible, téléchargez directement <a href="http://jean-luc.massat.perso.luminy.univ-amu.fr/ens/jee-pour-M2/ress/">Eclipse JEE</a>.</li>
<li>Préparez un projet Java standard pour tester les exemples présentés ci-dessous.</li>
</ul>

    <h3 id="principe">Principe
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#principe" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>La programmation par contrat consiste à séparer la spécification d'une couche logicielle (aussi appelée service) de sa réalisation. La spécification donne lieu à la création d'une interface et la réalisation fournit une classe qui implante cette interface. Ce ne sont pas nécessairement les mêmes personnes qui développent l'interface et son implantation. On peut également remarquer que la phase de réalisation peut produire plusieurs implantations différentes d'une même interface. Le choix entre ces implantations est réalisé à l'intégration entre les couches. Les objectifs de cette approche :</p>
<ul>
<li><p><strong>Réduire les dépendances.</strong></p>
<p>Les classes d'implantation ne se connaissent pas. Elles dialoguent au moyen des interfaces. De ce fait, on peut facilement changer un implantation contre une autre sans avoir à mettre à jour la totalité du logiciel.</p>
</li>
<li><p><strong>Faciliter les tests.</strong></p>
<p>Chaque couche logicielle ayant une spécification claire, il est facile de lui associer un jeu de tests utilisable quelque soit la nature de l'implantation.</p>
</li>
<li><p><strong>Simplifier le code.</strong></p>
<p>Dans certains cas de figure, le code d'une méthode est une suite de considérations sans liaison directe entre-elles. La programmation par contrat va faciliter la construction d'implantations façade qui se chargent chacune d'une partie du travail.</p>
</li>
<li><p><strong>Organiser le développement.</strong></p>
</li>
</ul>

    <h3 id="spécifier-un-service-logiciel">Spécifier un service logiciel
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#spécifier-un-service-logiciel" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Prenons un exemple pour éclairer ces principes. Nous avons besoin dans nos applications de pouvoir tracer un certain nombre d'évènements. Nous allons donc créer un service de trace (un <em>logger</em> en anglais). Ce service est spécifié par l'interface ci-dessous :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-0" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-0">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILogger</span> <span class="token punctuation">{</span>

    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    
    <h3 id="une-première-implantation">Une première implantation
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#une-première-implantation" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Pour utiliser ce service, nous avons besoin d'une classe qui implante ce service. Il existe plusieurs manières de faire. Nous allons, dans une premier temps, envoyer les messages de trace sur la console de sortie d'erreur standard :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-1" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-1">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StderrLogger</span> <span class="token keyword">implements</span> <span class="token class-name">ILogger</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Start "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Stop "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%tF %1$tR | %s\n"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Les méthodes start et stop correspondent à la phase de démarrage et de terminaison du service. Nous retrouverons ces méthodes dans toutes les implantations (même si elles sont vides).</p>
<p> A propos des packages. Vous pouvez noter dans cet exemple que l'interface est dans un package et que la classe d'implantation est dans un autre. Dans un cas réel, la spécification d'un service peut être composé de plusieurs interfaces accompagnées de javaBeans ou de classes d'exception. L'implantation de ce service peut également contenir plusieurs classes ce qui justifie clairement l'utilisation de plusieurs packages.</p>
<p>Nous pouvons maintenant utiliser ce service. Pour ce faire, nous allons construire une classe de test unitaire (avec JUnit 5 à ajouter dans le buildpath de votre projet Eclipse) :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-2" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-2">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>tests</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">AfterEach</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">BeforeEach</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp<span class="token punctuation">.</span></span><span class="token class-name">StderrLogger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestLoggerServices</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">beforeEachTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"===================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AfterEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterEachTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// use a logger</span>
    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token class-name">ILogger</span> logger<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Voila le résultat = hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Test StderrLogger</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// create the service</span>
        <span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// start the service</span>
        logger<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// use the service</span>
        <span class="token function">use</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// stop the service</span>
        logger<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p>A ce stade, nous pouvons remarquer que :</p>
<p> Les utilisateurs (la méthode use ci-dessus) n'ont aucune connaissance des détails de l'implantation. Seule l'interface est utilisée.
 Il existe tout de même une dépendance puisque le nom de la classe d'implantation apparaît en clair dans le code de l'utilisateur (méthode testStderrLogger).
 L'intégrateur (methode testStderrLogger) est responsable du respect du contrat (on appelle d'abord start, puis on utilise, puis on appelle stop).</p>

    <h3 id="une-deuxième-implantation">Une deuxième implantation
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#une-deuxième-implantation" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Nous pouvons aussi donner une deuxième implantation qui stocke les traces dans un fichier :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-3" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-3">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileNotFoundException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileLogger</span> <span class="token keyword">implements</span> <span class="token class-name">ILogger</span> <span class="token punctuation">{</span>

    <span class="token comment">// parameter: the writer</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">PrintWriter</span> writer<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">FileLogger</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"bad fileName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Start "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Stop "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        writer<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%tF %1$tR | %s\n"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Cette nouvelle implantation a absolument besoin d'un paramètre (le nom du fichier) pour être fonctionnelle. La solution retenue est la plus simple : ajouter un argument au constructeur. Nous remarquons que de ce fait, la méthode start n'a plus vraiment d'intérêt.</p>
<p>On remarque que le code d'intégration est très peu modifié (une ligne), alors que le fonctionnement est totalement différent. On remarque également que le code d'utilisation (méthode use) n'est pas altéré. Les modifications portent uniquement sur le code d'intégration :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-4" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-4">
      <pre class=" language-java"><code class=" language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFileLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileLogger</span><span class="token punctuation">(</span><span class="token string">"/tmp/myapp.log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">use</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>

    </div>
    
    <h3 id="une-troisième-implantation">Une troisième implantation
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#une-troisième-implantation" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>La plupart des classes d'implantation ont besoin de paramètres pour assurer leur service. Le choix de placer ces paramètres en argument du constructeur pose plusieurs problèmes :</p>
<ul>
<li> La classe obtenue n'est pas un javaBean (pas de constructeur vide). C'est particulièrement gênant car l'intérêt de ces composants élémentaires est très important.</li>
<li>Les paramètres du service sont fixés à sa création (par le constructeur). Il n'est donc pas possible de les changer en cours de route, voir même d'envisager un recyclage du service (changement des paramètres et nouvelle initialisation).</li>
<li>Si nous avons beaucoup de paramètres, le constructeur est difficile à utiliser.</li>
<li>Il n'est pas possible de prévoir des valeurs par défaut pour certains paramètres.</li>
</ul>
<p>Nous allons donc introduire une nouvelle solution au problème des paramètres : les paramètres vont être codés comme des propriétés de la classe d'implantation et la méthode start devra les utiliser pour initialiser le service. Nous obtenons donc cette nouvelle version :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-5" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-5">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileNotFoundException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">OutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanFileLogger</span> <span class="token keyword">implements</span> <span class="token class-name">ILogger</span> <span class="token punctuation">{</span>

    <span class="token comment">// parameter: writer name</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> fileName<span class="token punctuation">;</span>

    <span class="token comment">// property: writer</span>
    <span class="token keyword">private</span> <span class="token class-name">PrintWriter</span> writer<span class="token punctuation">;</span>

    <span class="token comment">// start service</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>fileName <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"no fileName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">OutputStream</span> os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"bad fileName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Start "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// stop service</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Stop "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        writer<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%tF %1$tR | %s\n"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getFileName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fileName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setFileName</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fileName <span class="token operator">=</span> fileName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Le code d'intégration a maintenant la responsabilité de fixer les paramètres du service avant d'appeler la méthode d'initialisation. Cette solution est plus simple et plus systématique quand le nombre de paramètres est important :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-6" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-6">
      <pre class=" language-java"><code class=" language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testBeanFileLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// create the service</span>
    <span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanFileLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// set parameter</span>
    logger<span class="token punctuation">.</span><span class="token function">setFileName</span><span class="token punctuation">(</span><span class="token string">"/tmp/myapp.log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// start</span>
    logger<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// use</span>
    <span class="token function">use</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// stop</span>
    logger<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Travail à faire : En donnant une valeur par défaut au paramètre de la classe BeanFileLogger nous pouvons rendre optionnelle la phase de paramétrage. mettez en oeuvre et testez ce principe.</p>

    <h2 id="injection-des-dépendances">Injection des dépendances
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#injection-des-dépendances" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h2>
    <p>L'injection des dépendances traite le délicat problème de la communication et de la dépendance entre services logiciels. Prenons l'exemple d'une classe métier :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-7" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-7">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ICalculator</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Construisons maintenant une implantation de ce service qui génère une trace après chaque appel d'une méthode métier. Cette implantation a donc besoin d'une couche logger pour s'exécuter correctement. Nous pourrions envisager de placer dans cette implantation la propriétés suivante :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-8" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-8">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ICalculator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleCalculator</span> <span class="token keyword">implements</span> <span class="token class-name">ICalculator</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">ILogger</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">myapp<span class="token punctuation">.</span>imp<span class="token punctuation">.</span></span>StderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Cette solution pose deux problèmes :</p>
<ol>
<li>Une dépendance directe vient d'être introduite entre cette implantation de la calculatrice et une implantation particulière de la couche logger. Cette dépendance est regrettable car inutile. La calculatrice doit utiliser l'interface ILogger et pas une implantation.</li>
<li>Si nous avions choisi une couche de trace ayant besoin d'un paramètre (comme celle vue précédemment), nous aurions sans doute dû inclure ce paramètre (le fichier de sortie) comme un paramètre de la calculatrice. En d'autres termes, les paramètres d'une couche A doivent inclure tous les paramètres des couches utilisées par A.</li>
</ol>
<p>Pour éviter ces problèmes, nous allons simplement introduire dans l'implantation de la calculatrice un paramètre faisant référence à une implantation de la couche logger. De ce fait, les deux implantations resteront indépendantes l'une de l'autre. Le seul point de contact sera l'interface ILogger :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-9" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-9">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ICalculator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleCalculator</span> <span class="token keyword">implements</span> <span class="token class-name">ICalculator</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">ILogger</span> logger<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>logger <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"null logger"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Start "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Stop "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"add(%d,%d)"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ILogger</span> <span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> logger<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLogger</span><span class="token punctuation">(</span><span class="token class-name">ILogger</span> logger<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>logger <span class="token operator">=</span> logger<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p>La phase d'intégration devient plus délicate puisqu'il faut créer et initialiser deux couches logicielles (il faut ajouter une clause import pour assertEquals) :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-10" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-10">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token class-name">ICalculator</span> calc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> calc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCalculorAndStderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// create and start the logger service (on stderr)</span>
    <span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// create, inject and start the calculator service</span>
    <span class="token keyword">var</span> calculator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleCalculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    calculator<span class="token punctuation">.</span><span class="token function">setLogger</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
    calculator<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// use the calculator service</span>
    <span class="token function">use</span><span class="token punctuation">(</span>calculator<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// stop the calculator service</span>
    calculator<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// stop the logger service</span>
    logger<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Nous pouvons très facilement et sans modifier la couche métier changer la politique de trace en utilisant un fichier. Il suffit de changer les quatre premières lignes du code d'intégration :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-11" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-11">
      <pre class=" language-java"><code class=" language-java"><span class="token comment">// create file logger</span>
<span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanFileLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
logger<span class="token punctuation">.</span><span class="token function">setFileName</span><span class="token punctuation">(</span><span class="token string">"/tmp/myapp.log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
logger<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

    </div>
    <p>Nous venons de mettre en oeuvre le principe de l'injection de dépendances. C'est la partie intégration qui se charge d'injecter dans la couche métier la référence vers la couche logger. Initialiser une application revient à créer les couches logicielles, injecter les dépendances et appeler les méthodes d'initialisation.</p>

    <h2 id="gestion-des-beans-par-spring">Gestion des beans par Spring
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#gestion-des-beans-par-spring" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h2>
    <p>La création des instances de javaBeans, l'injection des dépendances et le nommage des instances sont le coeur du framework Spring. Nous allons donc reprendre ces exemples en utilisant les outils fournis par Spring.</p>

    <h3 id="installation-de-spring">Installation de Spring
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#installation-de-spring" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Pour intégrer à votre projet le framework Spring et ses dépendances, nous allons utiliser Maven :</p>
<ul>
<li> Ajoutez Maven à votre projet : Sélectionnez votre projet / Bouton-droit / Configure / Convert to Maven Project. Vous devez à cette étape donner une numéro de version à votre projet. Laissez les valeurs par défaut.</li>
<li>L'action précédente a généré un fichier pom.xml qui est le coeur de la configuration de Maven. L'éditeur de ce fichier doit être ouvert. Ajoutez la dépendance ci-dessous (tirée de la page de chargement du site WEB de Spring):</li>
</ul>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-12" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-12">
      <pre class=" language-xml"><code class=" language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- pour utiliser Spring --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.2.4.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- pour utiliser la partie test de Spring --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.2.4.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- pour les annotations (à partir de java 10) --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>javax.annotation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>javax.annotation-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span></code></pre>

    </div>
    <ul>
<li> Vous devez avoir dans votre projet un répertoire Maven dependencies qui liste les .jar de Spring.</li>
<li>Préparez, dans un navigateur, un onglet vers la la documentation Spring.</li>
</ul>

    <h3 id="callbacks-par-annotations">Callbacks par annotations
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#callbacks-par-annotations" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Nous allons commencer par utiliser des annotations standards (non liées directement à Spring) pour indiquer dans nos classes les méthodes d'initialisation (@PostConstruct) et de terminaison (@PreDestroy). Ces méthodes seront automatiquement appelées par Spring.</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-13" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-13">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostConstruct</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PreDestroy</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StderrLogger</span> <span class="token keyword">implements</span> <span class="token class-name">ILogger</span> <span class="token punctuation">{</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

            <span class="token comment">// start service</span>
            <span class="token annotation punctuation">@PostConstruct</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// stop service</span>
        <span class="token annotation punctuation">@PreDestroy</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">}</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token punctuation">}</span></code></pre>

    </div>
    <p>À faire : ajoutez ces annotations à SimpleCalculator.java.</p>

    <h3 id="créer-et-utiliser-des-javabeans">Créer et utiliser des javaBeans
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#créer-et-utiliser-des-javabeans" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Dans Spring, la définition des javaBeans, leurs noms et leurs paramètres sont définis dans un fichier de configuration au format XML. Une fois ce fichier préparé, Spring est capable de créer les classes de service en effectuant les injections de dépendances et les initialisations nécessaires.</p>
<p>Préparez dans votre projet le fichier XML config.xml suivant dans le répertoire src :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-14" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-14">
      <pre class=" language-xml"><code class=" language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- pour utiliser les annotations --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>annotation-config</span> <span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- logger sur Stderr (logger par défaut)--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stderrLogger<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp.StderrLogger<span class="token punctuation">"</span></span> <span class="token attr-name">primary</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- logger sur /tmp/myapp.log --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileLogger<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp.BeanFileLogger<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileName<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/tmp/myapp.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- calculatrice qui trace sur Stderr --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>calculator<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp.SimpleCalculator<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logger<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stderrLogger<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span></code></pre>

    </div>
    <p>Nous allons pouvoir utiliser Spring pour exploiter la calculatrice et le logger :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-15" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-15">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>tests</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Assertions</span><span class="token punctuation">.</span>assertEquals<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">BeforeEach</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ICalculator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestSpring</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">beforeEachTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"===================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token class-name">ILogger</span> logger<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Voila le résultat"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token class-name">ICalculator</span> calc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> calc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"+++ StderrLogger"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> conf <span class="token operator">=</span> <span class="token string">"config.xml"</span><span class="token punctuation">;</span>

        <span class="token comment">// create a context and find beans</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token keyword">var</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> logger <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"stderrLogger"</span><span class="token punctuation">,</span> <span class="token class-name">ILogger</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">use</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCalculatorWithLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"+++ CalculatorWithLogger"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> conf <span class="token operator">=</span> <span class="token string">"config.xml"</span><span class="token punctuation">;</span>

        <span class="token comment">// create a context and find beans</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token keyword">var</span> ctx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> calc <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"calculator"</span><span class="token punctuation">,</span> <span class="token class-name">ICalculator</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">use</span><span class="token punctuation">(</span>calc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Si nous voulons changer le logger de la calculatrice, il n'est pas nécessaire de modifier notre programme. Il suffit de changer le fichier XML :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-16" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-16">
      <pre class=" language-xml"><code class=" language-xml"><span class="token comment">&lt;!-- calculatrice qui trace sur un fichier --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>calculator<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp.SimpleCalculator<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logger<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileLogger<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span></code></pre>

    </div>
    <p>Testez cette nouvelle version.</p>
<p>Nous pouvons même avoir deux versions de la calculatrice en fonction de la trace choisie.</p>
<p>Vous pouvez parcourir avec profit les trois premières sections de ce chapitre.</p>

    <h2 id="utilisez-les-annotations-de-spring">Utilisez les annotations de Spring
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#utilisez-les-annotations-de-spring" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h2>
    <p>Depuis java 1.5, le framework Spring est également capable de décrire la configuration des beans par un jeu d'annotations. Nous allons pouvoir décrire l'injection de dépendances et la création des instances de manière déclarative et laisser le soin à Spring de réaliser les opérations.</p>

    <h3 id="injection-par-annotation">Injection par annotation
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#injection-par-annotation" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Dans la classe SimpleCalculator, indiquez par une annotation (@Autowired) que vous souhaitez l'injection d'un classe logger :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-17" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-17">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleCalculator</span> <span class="token keyword">implements</span> <span class="token class-name">ICalculator</span> <span class="token punctuation">{</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

            <span class="token keyword">public</span> <span class="token class-name">ILogger</span> <span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> logger<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Autowired</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLogger</span><span class="token punctuation">(</span><span class="token class-name">ILogger</span> logger<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>logger <span class="token operator">=</span> logger<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span></code></pre>

    </div>
    <p>Le code XML est maintenant simplifié :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-18" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-18">
      <pre class=" language-xml"><code class=" language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- pour utiliser les annotations --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>annotation-config</span> <span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- logger sur Stderr (logger par défaut)--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stderrLogger<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp.StderrLogger<span class="token punctuation">"</span></span> <span class="token attr-name">primary</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- logger sur /tmp/myapp.log --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileLogger<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp.BeanFileLogger<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileName<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/tmp/myapp.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- calculatrice qui trace sur Stderr --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>calculator<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp.SimpleCalculator<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span></code></pre>

    </div>
    <p>L'injection, c'est à dire la liaison entre la classe utilisée et la classe utilisatrice, se réalise sur la base du type (ici l'interface ILogger) et du nom (ici « logger »).</p>
<p>Note : Il ya deux versions du logger (stderrLogger et fileLogger). L'attribut primary indique le service choisi par défaut.</p>

    <h3 id="déclarer-les-services-par-annotation">Déclarer les services par annotation
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#déclarer-les-services-par-annotation" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Nous pouvons également déclarer une classe comme étant un service. Cette annotation va permettre de l'instancier automatiquement en cas de besoin. Appliquons ce principe sur la classe StderrLogger (et faites la même chose sur SimpleCalculator) :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-19" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-19">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Primary</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span><span class="token string">"stderrLogger"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Primary</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StderrLogger</span> <span class="token keyword">implements</span> <span class="token class-name">ILogger</span> <span class="token punctuation">{</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p>Le code XML devient maintenant beaucoup plus simple :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-20" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-20">
      <pre class=" language-xml"><code class=" language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- pour utiliser les annotations --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>annotation-config</span> <span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- pour trouver les classes de service --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- logger sur /tmp/myapp.log --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileLogger<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myapp.imp.BeanFileLogger<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fileName<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/tmp/myapp.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span></code></pre>

    </div>
    
    <h3 id="contrôler-les-implantations-choisies">Contrôler les implantations choisies
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#contrôler-les-implantations-choisies" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h3>
    <p>Il existe souvent plusieurs implantations concurrentes d'un même service et nous avons besoin de contrôler le choix lors des injections.</p>
<ul>
<li> Supprimez l'annotation @Primary de StderrLogger.</li>
<li>À ce stade vous devez obtenir une erreur indiquant que deux classes sont disponibles pour l'interface ILogger.</li>
<li>Vous pouvez d'une part ajouter une clause @Qualifier à la classe StderrLogger:</li>
</ul>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-21" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-21">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Qualifier</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StderrLogger</span> <span class="token keyword">implements</span> <span class="token class-name">ILogger</span> <span class="token punctuation">{</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    <p> et ajouter la même annotation dans la classe SimpleCalculator:</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-22" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-22">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Qualifier</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleCalculator</span> <span class="token keyword">implements</span> <span class="token class-name">ICalculator</span> <span class="token punctuation">{</span>

        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

            <span class="token annotation punctuation">@Autowired</span>
            <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLogger</span><span class="token punctuation">(</span><span class="token class-name">ILogger</span> logger<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>logger <span class="token operator">=</span> logger<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span></code></pre>

    </div>
    <p>Découvrez d'autres possibilités de @Qualifier.</p>
<p>Découvrez d'autres possibilités des annotations.</p>

    <h2 id="intégration-junit-spring">Intégration JUnit / Spring
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#intégration-junit-spring" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h2>
    <p>Afin de rendre nos tests unitaires plus simples, nous pouvons utiliser une meilleure intégration de Spring et de Junit et injecter des beans directement dans la classe de test :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-23" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-23">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>tests</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Assertions</span><span class="token punctuation">.</span>assertEquals<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">BeforeEach</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span>extension<span class="token punctuation">.</span></span><span class="token class-name">ExtendWith</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ContextConfiguration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span></span><span class="token class-name">SpringExtension</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ICalculator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@ExtendWith</span><span class="token punctuation">(</span><span class="token class-name">SpringExtension</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span>locations <span class="token operator">=</span> <span class="token string">"/config.xml"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestSpringJUnitIntegration</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ILogger</span> logger<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ICalculator</span> calc<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@BeforeEach</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">beforeEachTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"===================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token class-name">ILogger</span> logger<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Voila le résultat"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token class-name">ICalculator</span> calc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> calc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"+++ StderrLogger"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">use</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCalculatorWithLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">use</span><span class="token punctuation">(</span>calc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    
    <h2 id="configurer-en-java">Configurer en Java
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#configurer-en-java" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h2>
    <p>Nous avons la possibilité, depuis la version 3, de configurer Spring en utilisant une classe et des annotations. Découvrez cette technique et créez de nouvelles versions de la couche BeanFileLogger.</p>
<ol>
<li><p>Débutez par la création d'une classe de configuration. Elle remplace complètement le fichier XML et, via des méthodes annotées @Bean, propose la création de services :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-24" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-24">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>tests</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Qualifier</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ComponentScan</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp<span class="token punctuation">.</span></span><span class="token class-name">BeanFileLogger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">"myapp.imp"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ILogger</span> <span class="token function">myLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanFileLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">setFileName</span><span class="token punctuation">(</span><span class="token string">"/tmp/essai.log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Production de "</span> <span class="token operator">+</span> logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> logger<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    </li>
<li><p>Nous pouvons créer un simple test pour construire un contexte et récupérer une instance :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-25" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-25">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>tests</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp<span class="token punctuation">.</span></span><span class="token class-name">StderrLogger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestAppConfig</span> <span class="token punctuation">{</span>

    <span class="token comment">/*
     * Construction d'un contexte classique
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">AppConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> logger <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">StderrLogger</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello on stderr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>

    </div>
    </li>
<li><p>Nous pouvons également utiliser l'intégration Spring/Junit pour récupérer et tester plusieurs services :</p>

    <div ng-version="9.0.7" class="code-header"><button mattooltip="Copier le code" class="btn" data-clipboard-target="#code-26" aria-describedby="cdk-describedby-message-2" cdk-describedby-host=""><i class="fas fa-copy"></i></button><!----></div><div id="code-26">
      <pre class=" language-java"><code class=" language-java"><span class="token keyword">package</span> <span class="token namespace">myapp<span class="token punctuation">.</span>tests</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Assertions</span><span class="token punctuation">.</span>assertEquals<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span>extension<span class="token punctuation">.</span></span><span class="token class-name">ExtendWith</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Qualifier</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ApplicationContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ContextConfiguration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span></span><span class="token class-name">SpringExtension</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>imp<span class="token punctuation">.</span></span><span class="token class-name">StderrLogger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ICalculator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">myapp<span class="token punctuation">.</span>services<span class="token punctuation">.</span></span><span class="token class-name">ILogger</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@ExtendWith</span><span class="token punctuation">(</span><span class="token class-name">SpringExtension</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token class-name">AppConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestAppConfigJunit</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ApplicationContext</span> context<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">StderrLogger</span> stderrLogger<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ICalculator</span> calculator<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testStderrLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stderrLogger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello on stderr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span>
    <span class="token class-name">ILogger</span> fileLogger<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFileLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fileLogger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello on file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testCalculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> calculator<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>

    </div>
    </li>
</ol>

    <h2 id="nouvelles-implantations">Nouvelles implantations
      <span _nghost-qpq-c108="" ng-version="9.0.7"><button _ngcontent-qpq-c108="" mattooltip="Copier le lien vers cette section" class="btn copy-button" data-clipboard-text="http://localhost:1864/blog/2020-10-23-introduction-spring#nouvelles-implantations" aria-describedby="cdk-describedby-message-1" cdk-describedby-host=""><i-feather _ngcontent-qpq-c108="" name="link-2" class="header-link" _nghost-qpq-c30=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="feather feather-link-2">
    <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line>
</svg></i-feather></button><!----></span>
    </h2>
    <p>Notre première version de la calculatrice mélange du code métier (addition) et du code de trace. Ce n'est pas une très bonne idée. Proposez une nouvelle implantation de décoration de la calculatrice qui est construite sur deux paramètres :</p>
<ul>
<li> une référence vers une autre implantation de la calculatrice (qui ne fait aucune trace),</li>
<li>une référence vers une implantation de la couche logger,</li>
</ul>
<p>Ce décorateur va retransmettre les requêtes et y associer une trace.</p>
</markdown>
    <div _ngcontent-qpq-c112="" style="display: none;">
      <!--scullyContent-begin--><h1 id="une-petite-introduction-à-spring" _ngcontent-qpq-c112="">Une (petite) introduction à Spring</h1>
<h2 id="introduction" _ngcontent-qpq-c112="">Introduction</h2>
<p _ngcontent-qpq-c112="">Le framework <a href="http://www.springframework.org/" _ngcontent-qpq-c112="">Spring</a> est une boite à outils très riche permettant de structurer, d'améliorer et de simplifier l'écriture d'application JEE. Spring est organisé en module :</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112="">Gestion des instances de classes (JavaBean et/ou métier),</li>
<li _ngcontent-qpq-c112="">Programmation orientée Aspect,</li>
<li _ngcontent-qpq-c112="">Modèle MVC et outils pour les applications WEB,</li>
<li _ngcontent-qpq-c112="">Outils pour la DAO (JDBC),</li>
<li _ngcontent-qpq-c112="">Outils pour les ORM (Hibernate, iBatis, ...),</li>
<li _ngcontent-qpq-c112="">Outils pour les applications JEE (JMX, JMA, JCA, EJB, ...).</li>
</ul>
<p _ngcontent-qpq-c112=""><a href="https://docs.spring.io/spring/docs/5.2.x/spring-framework-reference/overview.html" _ngcontent-qpq-c112="">Plus d'informations ici</a>.</p>
<h2 id="programmation-par-contrat" _ngcontent-qpq-c112="">Programmation par contrat</h2>
<p _ngcontent-qpq-c112="">Travail à faire :</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112="">Lancez Eclipse JEE (commande eclipse). Si la commande n'est pas disponible, téléchargez directement <a href="http://jean-luc.massat.perso.luminy.univ-amu.fr/ens/jee-pour-M2/ress/" _ngcontent-qpq-c112="">Eclipse JEE</a>.</li>
<li _ngcontent-qpq-c112="">Préparez un projet Java standard pour tester les exemples présentés ci-dessous.</li>
</ul>
<h3 id="principe" _ngcontent-qpq-c112="">Principe</h3>
<p _ngcontent-qpq-c112="">La programmation par contrat consiste à séparer la spécification d'une couche logicielle (aussi appelée service) de sa réalisation. La spécification donne lieu à la création d'une interface et la réalisation fournit une classe qui implante cette interface. Ce ne sont pas nécessairement les mêmes personnes qui développent l'interface et son implantation. On peut également remarquer que la phase de réalisation peut produire plusieurs implantations différentes d'une même interface. Le choix entre ces implantations est réalisé à l'intégration entre les couches. Les objectifs de cette approche :</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""><strong _ngcontent-qpq-c112="">Réduire les dépendances.</strong></li>
</ul>
<p _ngcontent-qpq-c112=""> Les classes d'implantation ne se connaissent pas. Elles dialoguent au moyen des interfaces. De ce fait, on peut facilement changer un implantation contre une autre sans avoir à mettre à jour la totalité du logiciel.</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""><strong _ngcontent-qpq-c112="">Faciliter les tests.</strong></li>
</ul>
<p _ngcontent-qpq-c112=""> Chaque couche logicielle ayant une spécification claire, il est facile de lui associer un jeu de tests utilisable quelque soit la nature de l'implantation.</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""><strong _ngcontent-qpq-c112="">Simplifier le code.</strong></li>
</ul>
<p _ngcontent-qpq-c112=""> Dans certains cas de figure, le code d'une méthode est une suite de considérations sans liaison directe entre-elles. La programmation par contrat va faciliter la construction d'implantations façade qui se chargent chacune d'une partie du travail.</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""><strong _ngcontent-qpq-c112="">Organiser le développement.</strong></li>
</ul>
<h3 id="spécifier-un-service-logiciel" _ngcontent-qpq-c112="">Spécifier un service logiciel</h3>
<p _ngcontent-qpq-c112="">Prenons un exemple pour éclairer ces principes. Nous avons besoin dans nos applications de pouvoir tracer un certain nombre d'évènements. Nous allons donc créer un service de trace (un <em _ngcontent-qpq-c112="">logger</em> en anglais). Ce service est spécifié par l'interface ci-dessous :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">interface</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token keyword" _ngcontent-qpq-c112="">default</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">String</span> message<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>  <span class="token punctuation" _ngcontent-qpq-c112="">}</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><h3 id="une-première-implantation" _ngcontent-qpq-c112="">Une première implantation</h3>
<p _ngcontent-qpq-c112="">Pour utiliser ce service, nous avons besoin d'une classe qui implante ce service. Il existe plusieurs manières de faire. Nous allons, dans une premier temps, envoyer les messages de trace sur la console de sortie d'erreur standard :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>util<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Date</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Start "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Stop "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Override</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">String</span> message<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">printf</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"%tF %1$tR | %s\n"</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">Date</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> message<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Les méthodes start et stop correspondent à la phase de démarrage et de terminaison du service. Nous retrouverons ces méthodes dans toutes les implantations (même si elles sont vides).</p>
<p _ngcontent-qpq-c112=""> A propos des packages. Vous pouvez noter dans cet exemple que l'interface est dans un package et que la classe d'implantation est dans un autre. Dans un cas réel, la spécification d'un service peut être composé de plusieurs interfaces accompagnées de javaBeans ou de classes d'exception. L'implantation de ce service peut également contenir plusieurs classes ce qui justifie clairement l'utilisation de plusieurs packages.</p>
<p _ngcontent-qpq-c112="">Nous pouvons maintenant utiliser ce service. Pour ce faire, nous allons construire une classe de test unitaire (avec JUnit 5 à ajouter dans le buildpath de votre projet Eclipse) :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>tests</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">AfterEach</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">BeforeEach</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Test</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">TestLoggerServices</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@BeforeEach</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">beforeEachTest</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"===================="</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@AfterEach</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">afterEachTest</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token comment" _ngcontent-qpq-c112="">// use a logger</span>
    <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Voila le résultat = hello"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token comment" _ngcontent-qpq-c112="">// Test StderrLogger</span>
    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testStderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token comment" _ngcontent-qpq-c112="">// create the service</span>
        <span class="token keyword" _ngcontent-qpq-c112="">var</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token comment" _ngcontent-qpq-c112="">// start the service</span>
        logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token comment" _ngcontent-qpq-c112="">// use the service</span>
        <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token comment" _ngcontent-qpq-c112="">// stop the service</span>
        logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">A ce stade, nous pouvons remarquer que :</p>
<p _ngcontent-qpq-c112=""> Les utilisateurs (la méthode use ci-dessus) n'ont aucune connaissance des détails de l'implantation. Seule l'interface est utilisée.
 Il existe tout de même une dépendance puisque le nom de la classe d'implantation apparaît en clair dans le code de l'utilisateur (méthode testStderrLogger).
 L'intégrateur (methode testStderrLogger) est responsable du respect du contrat (on appelle d'abord start, puis on utilise, puis on appelle stop).</p>
<h3 id="une-deuxième-implantation" _ngcontent-qpq-c112="">Une deuxième implantation</h3>
<p _ngcontent-qpq-c112="">Nous pouvons aussi donner une deuxième implantation qui stocke les traces dans un fichier :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>io<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">FileNotFoundException</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>io<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">FileOutputStream</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>io<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">PrintWriter</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>util<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Date</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">FileLogger</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token comment" _ngcontent-qpq-c112="">// parameter: the writer</span>
    <span class="token keyword" _ngcontent-qpq-c112="">private</span> <span class="token keyword" _ngcontent-qpq-c112="">final</span> <span class="token class-name" _ngcontent-qpq-c112="">PrintWriter</span> writer<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token class-name" _ngcontent-qpq-c112="">FileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">String</span> fileName<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">try</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>writer <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">PrintWriter</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">FileOutputStream</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>fileName<span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token boolean" _ngcontent-qpq-c112="">true</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span> <span class="token keyword" _ngcontent-qpq-c112="">catch</span> <span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">FileNotFoundException</span> e<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">throw</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">IllegalArgumentException</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"bad fileName"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Start "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        writer<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">close</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Stop "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Override</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">String</span> message<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        writer<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">printf</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"%tF %1$tR | %s\n"</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">Date</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> message<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Cette nouvelle implantation a absolument besoin d'un paramètre (le nom du fichier) pour être fonctionnelle. La solution retenue est la plus simple : ajouter un argument au constructeur. Nous remarquons que de ce fait, la méthode start n'a plus vraiment d'intérêt.</p>
<p _ngcontent-qpq-c112="">On remarque que le code d'intégration est très peu modifié (une ligne), alors que le fonctionnement est totalement différent. On remarque également que le code d'utilisation (méthode use) n'est pas altéré. Les modifications portent uniquement sur le code d'intégration :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testFileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
    <span class="token keyword" _ngcontent-qpq-c112="">var</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">FileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"/tmp/myapp.log"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><h3 id="une-troisième-implantation" _ngcontent-qpq-c112="">Une troisième implantation</h3>
<p _ngcontent-qpq-c112="">La plupart des classes d'implantation ont besoin de paramètres pour assurer leur service. Le choix de placer ces paramètres en argument du constructeur pose plusieurs problèmes :</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""> La classe obtenue n'est pas un javaBean (pas de constructeur vide). C'est particulièrement gênant car l'intérêt de ces composants élémentaires est très important.</li>
<li _ngcontent-qpq-c112="">Les paramètres du service sont fixés à sa création (par le constructeur). Il n'est donc pas possible de les changer en cours de route, voir même d'envisager un recyclage du service (changement des paramètres et nouvelle initialisation).</li>
<li _ngcontent-qpq-c112="">Si nous avons beaucoup de paramètres, le constructeur est difficile à utiliser.</li>
<li _ngcontent-qpq-c112="">Il n'est pas possible de prévoir des valeurs par défaut pour certains paramètres.</li>
</ul>
<p _ngcontent-qpq-c112="">Nous allons donc introduire une nouvelle solution au problème des paramètres : les paramètres vont être codés comme des propriétés de la classe d'implantation et la méthode start devra les utiliser pour initialiser le service. Nous obtenons donc cette nouvelle version :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>io<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">FileNotFoundException</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>io<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">FileOutputStream</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>io<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">OutputStream</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>io<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">PrintWriter</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">java<span class="token punctuation" _ngcontent-qpq-c112="">.</span>util<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Date</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">BeanFileLogger</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token comment" _ngcontent-qpq-c112="">// parameter: writer name</span>
    <span class="token keyword" _ngcontent-qpq-c112="">private</span> <span class="token class-name" _ngcontent-qpq-c112="">String</span> fileName<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token comment" _ngcontent-qpq-c112="">// property: writer</span>
    <span class="token keyword" _ngcontent-qpq-c112="">private</span> <span class="token class-name" _ngcontent-qpq-c112="">PrintWriter</span> writer<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token comment" _ngcontent-qpq-c112="">// start service</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">if</span> <span class="token punctuation" _ngcontent-qpq-c112="">(</span>fileName <span class="token operator" _ngcontent-qpq-c112="">==</span> <span class="token keyword" _ngcontent-qpq-c112="">null</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">throw</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">IllegalStateException</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"no fileName"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>
        <span class="token keyword" _ngcontent-qpq-c112="">try</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token class-name" _ngcontent-qpq-c112="">OutputStream</span> os <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">FileOutputStream</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>fileName<span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token boolean" _ngcontent-qpq-c112="">true</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
            <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>writer <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">PrintWriter</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>os<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span> <span class="token keyword" _ngcontent-qpq-c112="">catch</span> <span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">FileNotFoundException</span> e<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">throw</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">IllegalStateException</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"bad fileName"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Start "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token comment" _ngcontent-qpq-c112="">// stop service</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        writer<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">close</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Stop "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Override</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">String</span> message<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        writer<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">printf</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"%tF %1$tR | %s\n"</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">Date</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> message<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token class-name" _ngcontent-qpq-c112="">String</span> <span class="token function" _ngcontent-qpq-c112="">getFileName</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">return</span> fileName<span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">setFileName</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">String</span> fileName<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>fileName <span class="token operator" _ngcontent-qpq-c112="">=</span> fileName<span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Le code d'intégration a maintenant la responsabilité de fixer les paramètres du service avant d'appeler la méthode d'initialisation. Cette solution est plus simple et plus systématique quand le nombre de paramètres est important :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testBeanFileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
    <span class="token comment" _ngcontent-qpq-c112="">// create the service</span>
    <span class="token keyword" _ngcontent-qpq-c112="">var</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">BeanFileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token comment" _ngcontent-qpq-c112="">// set parameter</span>
    logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">setFileName</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"/tmp/myapp.log"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token comment" _ngcontent-qpq-c112="">// start</span>
    logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token comment" _ngcontent-qpq-c112="">// use</span>
    <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token comment" _ngcontent-qpq-c112="">// stop</span>
    logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Travail à faire : En donnant une valeur par défaut au paramètre de la classe BeanFileLogger nous pouvons rendre optionnelle la phase de paramétrage. mettez en oeuvre et testez ce principe.</p>
<h2 id="injection-des-dépendances" _ngcontent-qpq-c112="">Injection des dépendances</h2>
<p _ngcontent-qpq-c112="">L'injection des dépendances traite le délicat problème de la communication et de la dépendance entre services logiciels. Prenons l'exemple d'une classe métier :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">interface</span> <span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token keyword" _ngcontent-qpq-c112="">int</span> <span class="token function" _ngcontent-qpq-c112="">add</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token keyword" _ngcontent-qpq-c112="">int</span> a<span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token keyword" _ngcontent-qpq-c112="">int</span> b<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Construisons maintenant une implantation de ce service qui génère une trace après chaque appel d'une méthode métier. Cette implantation a donc besoin d'une couche logger pour s'exécuter correctement. Nous pourrions envisager de placer dans cette implantation la propriétés suivante :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">SimpleCalculator</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token keyword" _ngcontent-qpq-c112="">private</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span>StderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>
<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Cette solution pose deux problèmes :</p>
<ol _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112="">Une dépendance directe vient d'être introduite entre cette implantation de la calculatrice et une implantation particulière de la couche logger. Cette dépendance est regrettable car inutile. La calculatrice doit utiliser l'interface ILogger et pas une implantation.</li>
<li _ngcontent-qpq-c112="">Si nous avions choisi une couche de trace ayant besoin d'un paramètre (comme celle vue précédemment), nous aurions sans doute dû inclure ce paramètre (le fichier de sortie) comme un paramètre de la calculatrice. En d'autres termes, les paramètres d'une couche A doivent inclure tous les paramètres des couches utilisées par A.</li>
</ol>
<p _ngcontent-qpq-c112="">Pour éviter ces problèmes, nous allons simplement introduire dans l'implantation de la calculatrice un paramètre faisant référence à une implantation de la couche logger. De ce fait, les deux implantations resteront indépendantes l'une de l'autre. Le seul point de contact sera l'interface ILogger :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">SimpleCalculator</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token keyword" _ngcontent-qpq-c112="">private</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">if</span> <span class="token punctuation" _ngcontent-qpq-c112="">(</span>logger <span class="token operator" _ngcontent-qpq-c112="">==</span> <span class="token keyword" _ngcontent-qpq-c112="">null</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">throw</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">IllegalStateException</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"null logger"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Start "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Stop "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">int</span> <span class="token function" _ngcontent-qpq-c112="">add</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token keyword" _ngcontent-qpq-c112="">int</span> a<span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token keyword" _ngcontent-qpq-c112="">int</span> b<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">String</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">format</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"add(%d,%d)"</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> a<span class="token punctuation" _ngcontent-qpq-c112="">,</span> b<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token keyword" _ngcontent-qpq-c112="">return</span> <span class="token punctuation" _ngcontent-qpq-c112="">(</span>a <span class="token operator" _ngcontent-qpq-c112="">+</span> b<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token function" _ngcontent-qpq-c112="">getLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">return</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">setLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>logger <span class="token operator" _ngcontent-qpq-c112="">=</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">La phase d'intégration devient plus délicate puisqu'il faut créer et initialiser deux couches logicielles (il faut ajouter une clause import pour assertEquals) :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> calc<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
    <span class="token function" _ngcontent-qpq-c112="">assertEquals</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token number" _ngcontent-qpq-c112="">300</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> calc<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">add</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token number" _ngcontent-qpq-c112="">100</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token number" _ngcontent-qpq-c112="">200</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testCalculorAndStderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
    <span class="token comment" _ngcontent-qpq-c112="">// create and start the logger service (on stderr)</span>
    <span class="token keyword" _ngcontent-qpq-c112="">var</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token comment" _ngcontent-qpq-c112="">// create, inject and start the calculator service</span>
    <span class="token keyword" _ngcontent-qpq-c112="">var</span> calculator <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">SimpleCalculator</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    calculator<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">setLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    calculator<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token comment" _ngcontent-qpq-c112="">// use the calculator service</span>
    <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>calculator<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token comment" _ngcontent-qpq-c112="">// stop the calculator service</span>
    calculator<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token comment" _ngcontent-qpq-c112="">// stop the logger service</span>
    logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Nous pouvons très facilement et sans modifier la couche métier changer la politique de trace en utilisant un fichier. Il suffit de changer les quatre premières lignes du code d'intégration :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token comment" _ngcontent-qpq-c112="">// create file logger</span>
<span class="token keyword" _ngcontent-qpq-c112="">var</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">BeanFileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">setFileName</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"/tmp/myapp.log"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span></code></pre><p _ngcontent-qpq-c112="">Nous venons de mettre en oeuvre le principe de l'injection de dépendances. C'est la partie intégration qui se charge d'injecter dans la couche métier la référence vers la couche logger. Initialiser une application revient à créer les couches logicielles, injecter les dépendances et appeler les méthodes d'initialisation.</p>
<h2 id="gestion-des-beans-par-spring" _ngcontent-qpq-c112="">Gestion des beans par Spring</h2>
<p _ngcontent-qpq-c112="">La création des instances de javaBeans, l'injection des dépendances et le nommage des instances sont le coeur du framework Spring. Nous allons donc reprendre ces exemples en utilisant les outils fournis par Spring.</p>
<h3 id="installation-de-spring" _ngcontent-qpq-c112="">Installation de Spring</h3>
<p _ngcontent-qpq-c112="">Pour intégrer à votre projet le framework Spring et ses dépendances, nous allons utiliser Maven :</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""> Ajoutez Maven à votre projet : Sélectionnez votre projet / Bouton-droit / Configure / Convert to Maven Project. Vous devez à cette étape donner une numéro de version à votre projet. Laissez les valeurs par défaut.</li>
<li _ngcontent-qpq-c112="">L'action précédente a généré un fichier pom.xml qui est le coeur de la configuration de Maven. L'éditeur de ce fichier doit être ouvert. Ajoutez la dépendance ci-dessous (tirée de la page de chargement du site WEB de Spring):</li>
</ul>
<pre class="language-xml" _ngcontent-qpq-c112=""><code class="language-xml" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>dependencies</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- pour utiliser Spring --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>dependency</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>groupId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>org.springframework<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>groupId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>artifactId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>spring-context<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>artifactId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>version</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>5.2.4.RELEASE<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>version</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>dependency</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    
    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- pour utiliser la partie test de Spring --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>dependency</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>groupId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>org.springframework<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>groupId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>artifactId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>spring-test<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>artifactId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>version</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>5.2.4.RELEASE<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>version</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>dependency</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    
    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- pour les annotations (à partir de java 10) --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>dependency</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>groupId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>javax.annotation<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>groupId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>artifactId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>javax.annotation-api<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>artifactId</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>version</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>1.3.2<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>version</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>dependency</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>dependencies</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span></code></pre><ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""> Vous devez avoir dans votre projet un répertoire Maven dependencies qui liste les .jar de Spring.</li>
<li _ngcontent-qpq-c112="">Préparez, dans un navigateur, un onglet vers la la documentation Spring.</li>
</ul>
<h3 id="callbacks-par-annotations" _ngcontent-qpq-c112="">Callbacks par annotations</h3>
<p _ngcontent-qpq-c112="">Nous allons commencer par utiliser des annotations standards (non liées directement à Spring) pour indiquer dans nos classes les méthodes d'initialisation (@PostConstruct) et de terminaison (@PreDestroy). Ces méthodes seront automatiquement appelées par Spring.</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">javax<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">PostConstruct</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">javax<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">PreDestroy</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

        <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

            <span class="token comment" _ngcontent-qpq-c112="">// start service</span>
            <span class="token annotation punctuation" _ngcontent-qpq-c112="">@PostConstruct</span>
            <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">start</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

        <span class="token comment" _ngcontent-qpq-c112="">// stop service</span>
        <span class="token annotation punctuation" _ngcontent-qpq-c112="">@PreDestroy</span>
        <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">stop</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

        <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

    <span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">À faire : ajoutez ces annotations à SimpleCalculator.java.</p>
<h3 id="créer-et-utiliser-des-javabeans" _ngcontent-qpq-c112="">Créer et utiliser des javaBeans</h3>
<p _ngcontent-qpq-c112="">Dans Spring, la définition des javaBeans, leurs noms et leurs paramètres sont définis dans un fichier de configuration au format XML. Une fois ce fichier préparé, Spring est capable de créer les classes de service en effectuant les injections de dépendances et les initialisations nécessaires.</p>
<p _ngcontent-qpq-c112="">Préparez dans votre projet le fichier XML config.xml suivant dans le répertoire src :</p>
<pre class="language-xml" _ngcontent-qpq-c112=""><code class="language-xml" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>beans</span> <span class="token attr-name" _ngcontent-qpq-c112="">xmlns</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/beans<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xmlns:</span>xsi</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xmlns:</span>context</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/context<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xsi:</span>schemaLocation</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- pour utiliser les annotations --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span><span class="token namespace" _ngcontent-qpq-c112="">context:</span>annotation-config</span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- logger sur Stderr (logger par défaut)--&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>bean</span> <span class="token attr-name" _ngcontent-qpq-c112="">id</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>stderrLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">class</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp.StderrLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">primary</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>true<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- logger sur /tmp/myapp.log --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>bean</span> <span class="token attr-name" _ngcontent-qpq-c112="">id</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>fileLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">class</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp.BeanFileLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>property</span> <span class="token attr-name" _ngcontent-qpq-c112="">name</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>fileName<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
            <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>value</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>/tmp/myapp.log<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>value</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>property</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>bean</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- calculatrice qui trace sur Stderr --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>bean</span> <span class="token attr-name" _ngcontent-qpq-c112="">id</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>calculator<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">class</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp.SimpleCalculator<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>property</span> <span class="token attr-name" _ngcontent-qpq-c112="">name</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>logger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">ref</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>stderrLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>bean</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>

<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>beans</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span></code></pre><p _ngcontent-qpq-c112="">Nous allons pouvoir utiliser Spring pour exploiter la calculatrice et le logger :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>tests</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token keyword" _ngcontent-qpq-c112="">static</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Assertions</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>assertEquals<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">BeforeEach</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Test</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span>support<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ClassPathXmlApplicationContext</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">TestSpring</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@BeforeEach</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">beforeEachTest</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"===================="</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Voila le résultat"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> calc<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token function" _ngcontent-qpq-c112="">assertEquals</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token number" _ngcontent-qpq-c112="">300</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> calc<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">add</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token number" _ngcontent-qpq-c112="">100</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token number" _ngcontent-qpq-c112="">200</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testStderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"+++ StderrLogger"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token keyword" _ngcontent-qpq-c112="">var</span> conf <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token string" _ngcontent-qpq-c112="">"config.xml"</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

        <span class="token comment" _ngcontent-qpq-c112="">// create a context and find beans</span>
        <span class="token keyword" _ngcontent-qpq-c112="">try</span> <span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token keyword" _ngcontent-qpq-c112="">var</span> ctx <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">ClassPathXmlApplicationContext</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>conf<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">var</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> ctx<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">getBean</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"stderrLogger"</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token keyword" _ngcontent-qpq-c112="">class</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
            <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testCalculatorWithLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"+++ CalculatorWithLogger"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token keyword" _ngcontent-qpq-c112="">var</span> conf <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token string" _ngcontent-qpq-c112="">"config.xml"</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

        <span class="token comment" _ngcontent-qpq-c112="">// create a context and find beans</span>
        <span class="token keyword" _ngcontent-qpq-c112="">try</span> <span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token keyword" _ngcontent-qpq-c112="">var</span> ctx <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">ClassPathXmlApplicationContext</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>conf<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">var</span> calc <span class="token operator" _ngcontent-qpq-c112="">=</span> ctx<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">getBean</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"calculator"</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token keyword" _ngcontent-qpq-c112="">class</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
            <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>calc<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Si nous voulons changer le logger de la calculatrice, il n'est pas nécessaire de modifier notre programme. Il suffit de changer le fichier XML :</p>
<pre class="language-xml" _ngcontent-qpq-c112=""><code class="language-xml" _ngcontent-qpq-c112=""><span class="token comment" _ngcontent-qpq-c112="">&lt;!-- calculatrice qui trace sur un fichier --&gt;</span>
<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>bean</span> <span class="token attr-name" _ngcontent-qpq-c112="">id</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>calculator<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">class</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp.SimpleCalculator<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>property</span> <span class="token attr-name" _ngcontent-qpq-c112="">name</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>logger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">ref</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>fileLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>
<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>bean</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span></code></pre><p _ngcontent-qpq-c112="">Testez cette nouvelle version.</p>
<p _ngcontent-qpq-c112="">Nous pouvons même avoir deux versions de la calculatrice en fonction de la trace choisie.</p>
<p _ngcontent-qpq-c112="">Vous pouvez parcourir avec profit les trois premières sections de ce chapitre.</p>
<h2 id="utilisez-les-annotations-de-spring" _ngcontent-qpq-c112="">Utilisez les annotations de Spring</h2>
<p _ngcontent-qpq-c112="">Depuis java 1.5, le framework Spring est également capable de décrire la configuration des beans par un jeu d'annotations. Nous allons pouvoir décrire l'injection de dépendances et la création des instances de manière déclarative et laisser le soin à Spring de réaliser les opérations.</p>
<h3 id="injection-par-annotation" _ngcontent-qpq-c112="">Injection par annotation</h3>
<p _ngcontent-qpq-c112="">Dans la classe SimpleCalculator, indiquez par une annotation (@Autowired) que vous souhaitez l'injection d'un classe logger :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>beans<span class="token punctuation" _ngcontent-qpq-c112="">.</span>factory<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Autowired</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">SimpleCalculator</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

        <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

            <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token function" _ngcontent-qpq-c112="">getLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">return</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

        <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Autowired</span>
        <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">setLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>logger <span class="token operator" _ngcontent-qpq-c112="">=</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Le code XML est maintenant simplifié :</p>
<pre class="language-xml" _ngcontent-qpq-c112=""><code class="language-xml" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>beans</span> <span class="token attr-name" _ngcontent-qpq-c112="">xmlns</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/beans<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xmlns:</span>xsi</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xmlns:</span>context</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/context<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xsi:</span>schemaLocation</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- pour utiliser les annotations --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span><span class="token namespace" _ngcontent-qpq-c112="">context:</span>annotation-config</span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- logger sur Stderr (logger par défaut)--&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>bean</span> <span class="token attr-name" _ngcontent-qpq-c112="">id</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>stderrLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">class</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp.StderrLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">primary</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>true<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- logger sur /tmp/myapp.log --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>bean</span> <span class="token attr-name" _ngcontent-qpq-c112="">id</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>fileLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">class</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp.BeanFileLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>property</span> <span class="token attr-name" _ngcontent-qpq-c112="">name</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>fileName<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
            <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>value</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>/tmp/myapp.log<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>value</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>property</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>bean</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- calculatrice qui trace sur Stderr --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>bean</span> <span class="token attr-name" _ngcontent-qpq-c112="">id</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>calculator<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">class</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp.SimpleCalculator<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>

<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>beans</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span></code></pre><p _ngcontent-qpq-c112="">L'injection, c'est à dire la liaison entre la classe utilisée et la classe utilisatrice, se réalise sur la base du type (ici l'interface ILogger) et du nom (ici « logger »).</p>
<p _ngcontent-qpq-c112="">Note : Il ya deux versions du logger (stderrLogger et fileLogger). L'attribut primary indique le service choisi par défaut.</p>
<h3 id="déclarer-les-services-par-annotation" _ngcontent-qpq-c112="">Déclarer les services par annotation</h3>
<p _ngcontent-qpq-c112="">Nous pouvons également déclarer une classe comme étant un service. Cette annotation va permettre de l'instancier automatiquement en cas de besoin. Appliquons ce principe sur la classe StderrLogger (et faites la même chose sur SimpleCalculator) :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>
    
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Primary</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>stereotype<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Service</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token annotation punctuation" _ngcontent-qpq-c112="">@Service</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"stderrLogger"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
<span class="token annotation punctuation" _ngcontent-qpq-c112="">@Primary</span>
<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Le code XML devient maintenant beaucoup plus simple :</p>
<pre class="language-xml" _ngcontent-qpq-c112=""><code class="language-xml" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>beans</span> <span class="token attr-name" _ngcontent-qpq-c112="">xmlns</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/beans<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xmlns:</span>xsi</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xmlns:</span>context</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/context<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span>
       <span class="token attr-name" _ngcontent-qpq-c112=""><span class="token namespace" _ngcontent-qpq-c112="">xsi:</span>schemaLocation</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- pour utiliser les annotations --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span><span class="token namespace" _ngcontent-qpq-c112="">context:</span>annotation-config</span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- pour trouver les classes de service --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span><span class="token namespace" _ngcontent-qpq-c112="">context:</span>component-scan</span> <span class="token attr-name" _ngcontent-qpq-c112="">base-package</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token punctuation" _ngcontent-qpq-c112="">/&gt;</span></span>

    <span class="token comment" _ngcontent-qpq-c112="">&lt;!-- logger sur /tmp/myapp.log --&gt;</span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>bean</span> <span class="token attr-name" _ngcontent-qpq-c112="">id</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>fileLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span> <span class="token attr-name" _ngcontent-qpq-c112="">class</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>myapp.imp.BeanFileLogger<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>property</span> <span class="token attr-name" _ngcontent-qpq-c112="">name</span><span class="token attr-value" _ngcontent-qpq-c112=""><span class="token punctuation attr-equals" _ngcontent-qpq-c112="">=</span><span class="token punctuation" _ngcontent-qpq-c112="">"</span>fileName<span class="token punctuation" _ngcontent-qpq-c112="">"</span></span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
            <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;</span>value</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>/tmp/myapp.log<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>value</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
        <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>property</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>
    <span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>bean</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span>

<span class="token tag" _ngcontent-qpq-c112=""><span class="token tag" _ngcontent-qpq-c112=""><span class="token punctuation" _ngcontent-qpq-c112="">&lt;/</span>beans</span><span class="token punctuation" _ngcontent-qpq-c112="">&gt;</span></span></code></pre><h3 id="contrôler-les-implantations-choisies" _ngcontent-qpq-c112="">Contrôler les implantations choisies</h3>
<p _ngcontent-qpq-c112="">Il existe souvent plusieurs implantations concurrentes d'un même service et nous avons besoin de contrôler le choix lors des injections.</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""> Supprimez l'annotation @Primary de StderrLogger.</li>
<li _ngcontent-qpq-c112="">À ce stade vous devez obtenir une erreur indiquant que deux classes sont disponibles pour l'interface ILogger.</li>
<li _ngcontent-qpq-c112="">Vous pouvez d'une part ajouter une clause @Qualifier à la classe StderrLogger:</li>
</ul>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>beans<span class="token punctuation" _ngcontent-qpq-c112="">.</span>factory<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Qualifier</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>stereotype<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Service</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token annotation punctuation" _ngcontent-qpq-c112="">@Service</span>
<span class="token annotation punctuation" _ngcontent-qpq-c112="">@Qualifier</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"test"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112=""> et ajouter la même annotation dans la classe SimpleCalculator:</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>beans<span class="token punctuation" _ngcontent-qpq-c112="">.</span>factory<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Qualifier</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>beans<span class="token punctuation" _ngcontent-qpq-c112="">.</span>factory<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Autowired</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">SimpleCalculator</span> <span class="token keyword" _ngcontent-qpq-c112="">implements</span> <span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

        <span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>

            <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Autowired</span>
            <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Qualifier</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"test"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
            <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">setLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">this</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>logger <span class="token operator" _ngcontent-qpq-c112="">=</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><p _ngcontent-qpq-c112="">Découvrez d'autres possibilités de @Qualifier.</p>
<p _ngcontent-qpq-c112="">Découvrez d'autres possibilités des annotations.</p>
<h2 id="intégration-junit--spring" _ngcontent-qpq-c112="">Intégration JUnit / Spring</h2>
<p _ngcontent-qpq-c112="">Afin de rendre nos tests unitaires plus simples, nous pouvons utiliser une meilleure intégration de Spring et de Junit et injecter des beans directement dans la classe de test :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>tests</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token keyword" _ngcontent-qpq-c112="">static</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Assertions</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>assertEquals<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">BeforeEach</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Test</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span>extension<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ExtendWith</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>beans<span class="token punctuation" _ngcontent-qpq-c112="">.</span>factory<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Autowired</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>test<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ContextConfiguration</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>test<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">SpringExtension</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token annotation punctuation" _ngcontent-qpq-c112="">@ExtendWith</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">SpringExtension</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token keyword" _ngcontent-qpq-c112="">class</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
<span class="token annotation punctuation" _ngcontent-qpq-c112="">@ContextConfiguration</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>locations <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token string" _ngcontent-qpq-c112="">"/config.xml"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">TestSpringJUnitIntegration</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Autowired</span>
    <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Autowired</span>
    <span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> calc<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@BeforeEach</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">beforeEachTest</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"===================="</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Voila le résultat"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> calc<span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token function" _ngcontent-qpq-c112="">assertEquals</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token number" _ngcontent-qpq-c112="">300</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> calc<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">add</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token number" _ngcontent-qpq-c112="">100</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token number" _ngcontent-qpq-c112="">200</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testStderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"+++ StderrLogger"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testCalculatorWithLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token function" _ngcontent-qpq-c112="">use</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>calc<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre><h2 id="configurer-en-java" _ngcontent-qpq-c112="">Configurer en Java</h2>
<p _ngcontent-qpq-c112="">Nous avons la possibilité, depuis la version 3, de configurer Spring en utilisant une classe et des annotations. Découvrez cette technique et créez de nouvelles versions de la couche BeanFileLogger.</p>
<ol _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""><p _ngcontent-qpq-c112="">Débutez par la création d'une classe de configuration. Elle remplace complètement le fichier XML et, via des méthodes annotées @Bean, propose la création de services :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>tests</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>beans<span class="token punctuation" _ngcontent-qpq-c112="">.</span>factory<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Qualifier</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Bean</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ComponentScan</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>stereotype<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Component</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">BeanFileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token annotation punctuation" _ngcontent-qpq-c112="">@Component</span>
<span class="token annotation punctuation" _ngcontent-qpq-c112="">@ComponentScan</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"myapp.imp"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">AppConfig</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Bean</span>
    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Qualifier</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"file"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> <span class="token function" _ngcontent-qpq-c112="">myLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">var</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">BeanFileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">setFileName</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"/tmp/essai.log"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token class-name" _ngcontent-qpq-c112="">System</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>err<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">println</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"Production de "</span> <span class="token operator" _ngcontent-qpq-c112="">+</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token keyword" _ngcontent-qpq-c112="">return</span> logger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre></li>
<li _ngcontent-qpq-c112=""><p _ngcontent-qpq-c112="">Nous pouvons créer un simple test pour construire un contexte et récupérer une instance :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>tests</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Test</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">AnnotationConfigApplicationContext</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">TestAppConfig</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token comment" _ngcontent-qpq-c112="">/*
     * Construction d'un contexte classique
     */</span>
    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testStderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token keyword" _ngcontent-qpq-c112="">try</span> <span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token keyword" _ngcontent-qpq-c112="">var</span> c <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token keyword" _ngcontent-qpq-c112="">new</span> <span class="token class-name" _ngcontent-qpq-c112="">AnnotationConfigApplicationContext</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">AppConfig</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token keyword" _ngcontent-qpq-c112="">class</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
            <span class="token keyword" _ngcontent-qpq-c112="">var</span> logger <span class="token operator" _ngcontent-qpq-c112="">=</span> c<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">getBean</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token keyword" _ngcontent-qpq-c112="">class</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
            logger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"hello on stderr"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
        <span class="token punctuation" _ngcontent-qpq-c112="">}</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>
<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre></li>
<li _ngcontent-qpq-c112=""><p _ngcontent-qpq-c112="">Nous pouvons également utiliser l'intégration Spring/Junit pour récupérer et tester plusieurs services :</p>
<pre class="language-java" _ngcontent-qpq-c112=""><code class="language-java" _ngcontent-qpq-c112=""><span class="token keyword" _ngcontent-qpq-c112="">package</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>tests</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token keyword" _ngcontent-qpq-c112="">static</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Assertions</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span>assertEquals<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Test</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span>api<span class="token punctuation" _ngcontent-qpq-c112="">.</span>extension<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ExtendWith</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>beans<span class="token punctuation" _ngcontent-qpq-c112="">.</span>factory<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Autowired</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>beans<span class="token punctuation" _ngcontent-qpq-c112="">.</span>factory<span class="token punctuation" _ngcontent-qpq-c112="">.</span>annotation<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">Qualifier</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ApplicationContext</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>test<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ContextConfiguration</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">org<span class="token punctuation" _ngcontent-qpq-c112="">.</span>springframework<span class="token punctuation" _ngcontent-qpq-c112="">.</span>test<span class="token punctuation" _ngcontent-qpq-c112="">.</span>context<span class="token punctuation" _ngcontent-qpq-c112="">.</span>junit<span class="token punctuation" _ngcontent-qpq-c112="">.</span>jupiter<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">SpringExtension</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>imp<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
<span class="token keyword" _ngcontent-qpq-c112="">import</span> <span class="token namespace" _ngcontent-qpq-c112="">myapp<span class="token punctuation" _ngcontent-qpq-c112="">.</span>services<span class="token punctuation" _ngcontent-qpq-c112="">.</span></span><span class="token class-name" _ngcontent-qpq-c112="">ILogger</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>

<span class="token annotation punctuation" _ngcontent-qpq-c112="">@ExtendWith</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token class-name" _ngcontent-qpq-c112="">SpringExtension</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token keyword" _ngcontent-qpq-c112="">class</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
<span class="token annotation punctuation" _ngcontent-qpq-c112="">@ContextConfiguration</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span>classes <span class="token operator" _ngcontent-qpq-c112="">=</span> <span class="token class-name" _ngcontent-qpq-c112="">AppConfig</span><span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token keyword" _ngcontent-qpq-c112="">class</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
<span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">class</span> <span class="token class-name" _ngcontent-qpq-c112="">TestAppConfigJunit</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Autowired</span>
    <span class="token class-name" _ngcontent-qpq-c112="">ApplicationContext</span> context<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Autowired</span>
    <span class="token class-name" _ngcontent-qpq-c112="">StderrLogger</span> stderrLogger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Autowired</span>
    <span class="token class-name" _ngcontent-qpq-c112="">ICalculator</span> calculator<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testStderrLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        stderrLogger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"hello on stderr"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Autowired</span>
    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Qualifier</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"file"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span>
    <span class="token class-name" _ngcontent-qpq-c112="">ILogger</span> fileLogger<span class="token punctuation" _ngcontent-qpq-c112="">;</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testFileLogger</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        fileLogger<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">log</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token string" _ngcontent-qpq-c112="">"hello on file"</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

    <span class="token annotation punctuation" _ngcontent-qpq-c112="">@Test</span>
    <span class="token keyword" _ngcontent-qpq-c112="">public</span> <span class="token keyword" _ngcontent-qpq-c112="">void</span> <span class="token function" _ngcontent-qpq-c112="">testCalculator</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span> <span class="token punctuation" _ngcontent-qpq-c112="">{</span>
        <span class="token function" _ngcontent-qpq-c112="">assertEquals</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token number" _ngcontent-qpq-c112="">30</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> calculator<span class="token punctuation" _ngcontent-qpq-c112="">.</span><span class="token function" _ngcontent-qpq-c112="">add</span><span class="token punctuation" _ngcontent-qpq-c112="">(</span><span class="token number" _ngcontent-qpq-c112="">10</span><span class="token punctuation" _ngcontent-qpq-c112="">,</span> <span class="token number" _ngcontent-qpq-c112="">20</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">)</span><span class="token punctuation" _ngcontent-qpq-c112="">;</span>
    <span class="token punctuation" _ngcontent-qpq-c112="">}</span>

<span class="token punctuation" _ngcontent-qpq-c112="">}</span></code></pre></li>
</ol>
<h2 id="nouvelles-implantations" _ngcontent-qpq-c112="">Nouvelles implantations</h2>
<p _ngcontent-qpq-c112="">Notre première version de la calculatrice mélange du code métier (addition) et du code de trace. Ce n'est pas une très bonne idée. Proposez une nouvelle implantation de décoration de la calculatrice qui est construite sur deux paramètres :</p>
<ul _ngcontent-qpq-c112="">
<li _ngcontent-qpq-c112=""> une référence vers une autre implantation de la calculatrice (qui ne fait aucune trace),</li>
<li _ngcontent-qpq-c112="">une référence vers une implantation de la couche logger,</li>
</ul>
<p _ngcontent-qpq-c112="">Ce décorateur va retransmettre les requêtes et y associer une trace.</p>
<!--scullyContent-end--><scully-content _ngcontent-qpq-c112="" class="ng-star-inserted"></scully-content><!---->
    <script>try {window['scullyContent'] = {cssId:"_ngcontent-qpq-c112",html:document.body.innerHTML.split('<!--scullyContent-begin-->')[1].split('<!--scullyContent-end-->')[0]};} catch(e) {console.error('scully could not parse content');}</script></div>
  </div>
</div>
</app-blog><!----></main></div></mat-sidenav-content><!----></mat-sidenav-container></div></app-main-layout><!----></app-root-scully>
  <script id="ScullyIO-transfer-state"></script><script src="runtime-es2015.7726ca66e19a32ffa74a.js" type="module"></script><script src="runtime-es5.7726ca66e19a32ffa74a.js" nomodule="" defer=""></script><script src="polyfills-es5.c3277da7b523800d2de4.js" nomodule="" defer=""></script><script src="polyfills-es2015.bc41055869a547cef3f1.js" type="module"></script><script src="scripts.45564e58e5450acb2b4e.js" defer=""></script><script src="main-es2015.d41a9fa424eee9efba50.js" type="module"></script><script src="main-es5.d41a9fa424eee9efba50.js" nomodule="" defer=""></script>

<div class="cdk-live-announcer-element cdk-visually-hidden" aria-atomic="true" aria-live="polite"></div><div id="cdk-describedby-message-container" aria-hidden="true" style="display: none;"><div id="cdk-describedby-message-0">Partager le post</div><div id="cdk-describedby-message-1">Copier le lien vers cette section</div><div id="cdk-describedby-message-2">Copier le code</div></div></body></html>